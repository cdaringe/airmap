"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{4849:function(r,n,e){function t(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var e=[],t=!0,i=!1,a=void 0;try{for(var u,o=r[Symbol.iterator]();!(t=(u=o.next()).done)&&(e.push(u.value),!n||e.length!==n);t=!0);}catch(c){i=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(i)throw a}}return e}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}e.d(n,{q:function(){return i}});var i=function(r){return function(n){var e=t(n,2),i=e[0],a=e[1];return["all",[">=",r,i],["<",r,a]]}}},7849:function(r,n,e){e.r(n),e.d(n,{getResources:function(){return v}});var t={};e.r(t),e.d(t,{getLevels:function(){return m},getLevelsByField:function(){return s},makeGetLevels:function(){return l}});var i=e(4849);function a(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function u(r){return function(r){if(Array.isArray(r)){for(var n=0,e=new Array(r.length);n<r.length;n++)e[n]=r[n];return e}}(r)||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o,c=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173","black"],f=[0,.25,.5,1,2.5,5,20].map((function(r,n,e){return[r,e[n+1]||1/0]})),l=function(r){return function(n){var e=n.isMinMaxDynamicRange,t=n.geojson,a=0,o=1/0,l=-1/0,s=!0,m=!1,d=void 0;try{for(var p,v=t.features[Symbol.iterator]();!(s=(p=v.next()).done);s=!0){(a=p.value.properties[r])>l&&(l=a),a<o&&(o=a)}}catch(b){m=!0,d=b}finally{try{s||null==v.return||v.return()}finally{if(m)throw d}}var h=c.length,y=e?(l-o)/h:0,g=e?u(new Array(h)).map((function(r,n){var e=o+n*y;return[e,e+y]})):f;return{circleCases:g.map((0,i.q)(["get",r])).flatMap((function(r,n){return[r,c[n]]})),colors:c,fieldName:r,ranges:g}}},s=(a(o={},"PM0.5 \u03bcg/m^3 (derived)",l("pm05Derived")),a(o,"PM0.5 \u03bcg/m^3 (naive)",l("pm05Naive")),a(o,"PM2.5 \u03bcg/m^3",l("pm_2_5")),a(o,"PM0.5 \u03bcg/m^3 (calibrated)",l("pm05Calibrated")),a(o,"PM0.5-3 \u03bcg/m^3 (calibrated)",l("pm05To3Calibrated")),o),m=s["PM0.5 \u03bcg/m^3 (derived)"],d=e(1321);function p(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var v=function(){return function(r){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{},t=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e).filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})))),t.forEach((function(n){p(r,n,e[n])}))}return r}({},{mapbox:t},{stream:d})}},1321:function(r,n,e){e.r(n),e.d(n,{RHO_GRIMM:function(){return f},parse:function(){return g},sum:function(){return s},"toPartial\u03bcgPerM3":function(){return p},"toPartial\u03bcgPerM3SansRho":function(){return v}});var t=e(4235),i=e.n(t),a=e(6930);function u(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var e=[],t=!0,i=!1,a=void 0;try{for(var u,o=r[Symbol.iterator]();!(t=(u=o.next()).done)&&(e.push(u.value),!n||e.length!==n);t=!0);}catch(c){i=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(i)throw a}}return e}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(r,n,e,t,i,a,u){try{var o=r[a](u),c=o.value}catch(f){return void e(f)}o.done?n(c):Promise.resolve(c).then(t,i)}var c,f=1800,l=[6.842765,7.1751666,7.0114602,6.9088991,7.0263146,6.9180838,7.0393966,6.989318,6.9812267,5.2701795,14.0655402,13.8262107,14.1929174,14.0017841,13.8883794,13.9963284,14.0409634,14.2779903,13.8513492,13.898864,13.6873067,14.3390373,13.8184393,14.1478588,14.0655395,13.8262102,14.1929179,13.8296286,14.062005,13.9963317,14.040958,14.001345,13.96783,14,13.95533,14.00924,14,14,14,14,14],s=function(){for(var r=arguments.length,n=new Array(r),e=0;e<r;e++)n[e]=arguments[e];return n.reduce((function(r,n){return r+n}),0)},m=function(r){return r/1e9},d=function(r){return 1e6*r},p=function(r,n,e,t){return d(r)/l[e]*(Math.PI/6)*Math.pow(m(n),3)*t*1e9},v=function(r,n,e){return d(r)/l[e]*(Math.PI/6)*Math.pow(m(n),3)*1e9},h=function(r){return new Date(r.trim().split(" ").map((function(r,n){if(0===n){var e=u(r.split("/"),3),t=e[0],i=e[1],a=e[2],o=function(r){return 1===r.length?"0".concat(r):r};return"".concat(t,"-").concat(o(i),"-").concat(o(a))}return"T".concat(r,".000+01:00")})).join(""))},y=function(r){return parseFloat(r)},g=(c=i().mark((function r(n,e){var t,u,o,c,l,s,m;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=void 0===e?{records:[],partial:"",particleDiametersAscending:[]}:e,r.next=3,n.read();case 3:return u=r.sent,o=u.done,((c=u.value)||o)&&(t.partial+="string"===typeof c?c:c?(new TextDecoder).decode(c):"",l=t.partial.split(/\n/g),s=l.map((function(r){return r.trim()})).filter((function(r){return!!r})),m=s.length-1,s.forEach((function(r,n){if(m!==n||o){var e=r.includes(",")?r.split(","):r.split("\t");if(t.headerIndiciesByName){var i=e[t.headerIndiciesByName.Time],u=e[t.headerIndiciesByName["pm2.5 [ug/m3]"]];(0,a.k)(i,"date missing"),(0,a.k)(Number.isFinite(u),"column 'pm2.5 [ug/m3]' missing");for(var c=0,l=t.headerIndiciesByName["10.00 nm"],s=t.headerIndiciesByName["449.48 nm"],d=t.headerIndiciesByName["3238.77 nm"],v=[],g=0,b={sub500nm:[],sub3000nm:[]};l<d;){var w=parseFloat(e[l]),P=(t.particleDiametersAscending[g]+t.particleDiametersAscending[g+1])/2,M={value:w,diameterMidpointNm:P,calibrationIndex:g},A=p(w,P,g,f);l<s&&(b.sub500nm.push(M),c+=A),l<d&&b.sub3000nm.push(M),++l,++g}console.log({sampleNum:t.records.length,pm05:c,debug:v}),t.records.push({channels:b,date:h(i),debug:v,pm05EndCol:s,pm05Naive:c,pm_2_5:y(u)}),o&&(t.partial="")}else t.headerCells=e,t.headerIndiciesByName=e.reduce((function(r,n,e){var i=n.trim();r[i]=e;var a=i.match(/\s*(\d+\.\d+)\s+nm/);return a&&t.particleDiametersAscending.push(parseInt(a[1],10)),r}),{})}else t.partial=r}))),r.abrupt("return",o?t:g(n,t));case 8:case"end":return r.stop()}}),r)})),function(){var r=this,n=arguments;return new Promise((function(e,t){var i=c.apply(r,n);function a(r){o(i,e,t,a,u,"next",r)}function u(r){o(i,e,t,a,u,"throw",r)}a(void 0)}))})},6930:function(r,n,e){function t(r,n){if(null===r||void 0===r)throw Error(n)}e.d(n,{k:function(){return t}})}}]);