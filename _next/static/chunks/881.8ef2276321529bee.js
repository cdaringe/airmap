"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[881],{22483:(e,t,r)=>{r.d(t,{A:()=>n});function n(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}},77031:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(70573),a=r(22483);function i(e){(0,a.A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||(void 0===e?"undefined":(0,n._)(e))==="object"&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(Error().stack)),new Date(NaN))}},60502:(e,t,r)=>{r.d(t,{zB:()=>o,k8:()=>s,DM:()=>u});var n=r(12551),a=r(61760),i=r(69152);function o(e){try{var t=new URL(e),r=(0,n._)(t.pathname.substr(1).split("/"),3),a=r[0],i=r[1],o=r[2];if("spreadsheets"===a&&"d"===i&&o&&t.host.match("google.com"))return!0}catch(e){}return!1}function u(e){var t=new URL(e);return t.pathname=(0,a._)(t.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(t)}var s=function(e){var t=new URL(e),r=new URLSearchParams(t.search);return r.has("format")||r.set("format","csv"),t.search=r.toString(),fetch(u(t.toString()),{mode:"cors",redirect:"follow",headers:{accept:"text"}}).then(function(e){return e.body}).then(function(e){var t=null==e?void 0:e.getReader();return(0,i.V)(t,"missing stream body"),t})}},56347:(e,t,r)=>{r.d(t,{t:()=>a});var n=r(12551),a=function(e){return function(t){var r=(0,n._)(t,2);return["all",[">=",e,r[0]],["<",e,r[1]]]}}},66881:(e,t,r)=>{r.r(t),r.d(t,{getResources:()=>A});var n={};r.r(n),r.d(n,{combine:()=>_,dateField:()=>D,download:()=>w,downloadGeoJSON:()=>I,toGeoJSON:()=>N});var a={};r.r(a),r.d(a,{getLevels:()=>j});var i=r(48967),o=r(34618),u=r(92831),s=r(12551),c=r(65959),l=r(77031),d=r(22483),f=r(60502),p=r(69152),m=r(14952),h={voc_ppb:function(e){return parseInt(e)},date:function(e){return new Date(1e3*parseInt(e))},pm_2_5:function(e){return parseFloat(e)}},v=function(){var e=(0,i._)(function(e){var t,r,n,a,i,s,l=arguments;return(0,c.YH)(this,function(c){switch(c.label){case 0:return t=l.length>1&&void 0!==l[1]?l[1]:{records:[],partial:""},[4,e.read()];case 1:return n=(r=c.sent()).done,((a=r.value)||n)&&(t.partial+="string"==typeof a?a:a?new TextDecoder().decode(a):"",s=(i=t.partial.split(/\n/g)).length-1,i.forEach(function(e,r){if(s!==r||n){var a=e.split(",");if(t.headerIndiciesByName){var i="VOC (ppb)",c=a[t.headerIndiciesByName[i]],l=a[t.headerIndiciesByName.timestamp],d=a[t.headerIndiciesByName["pm 2.5 (ug/m3)"]];(0,p.V)(c,"voc missing (".concat(i,", value: ").concat(c,")")),(0,p.V)(l,"timestamp missing"),(0,p.V)(d,"pm25 missing"),t.records.push({voc_ppb:h.voc_ppb(c),date:h.date(l),pm_2_5:h.pm_2_5(d)}),n&&(t.partial="")}else t.headerIndiciesByName=a.reduce(function(e,t,r){return(0,u._)((0,o._)({},e),(0,m._)({},t.trim(),r))},{})}else t.partial=e})),[2,n?t:v(e,t)]}})});return function(t){return e.apply(this,arguments)}}(),g={timestamp:function(e){return 1e3*parseInt(e)},latitude:function(e){return parseFloat(e)},longitude:function(e){return parseFloat(e)}},y=function(){var e=(0,i._)(function(e){var t,r,n,a,i,s,l=arguments;return(0,c.YH)(this,function(c){switch(c.label){case 0:return t=l.length>1&&void 0!==l[1]?l[1]:{records:[],partial:""},[4,e.read()];case 1:return n=(r=c.sent()).done,((a=r.value)||n)&&(t.partial+="string"==typeof a?a:a?new TextDecoder().decode(a):"",s=(i=t.partial.split(/\n/g)).length-1,i.forEach(function(e,r){if(s!==r||n){var a=e.split(",");t.headerIndiciesByName?(t.records.push({timestamp:g.timestamp(a[t.headerIndiciesByName.timestamp]),latitude:g.latitude(a[t.headerIndiciesByName.latitude]),longitude:g.longitude(a[t.headerIndiciesByName.longitude])}),n&&(t.partial="")):t.headerIndiciesByName=a.reduce(function(e,t,r){return(0,u._)((0,o._)({},e),(0,m._)({},t.trim(),r))},{})}else t.partial=e})),[2,n?t:y(e,t)]}})});return function(t){return e.apply(this,arguments)}}(),b=function(e,t){for(var r=[],n=0;n<e;)r.push(t[n]),++n;return r},_=function(){var e=(0,i._)(function(e){var t,r,n,a,i,s,f,p,m,h,v,g,y;return(0,c.YH)(this,function(_){switch(_.label){case 0:t=e.measures,r=e.positions,t.length!==r.length&&console.warn("lossy data - measures ".concat(t.length,", positions ").concat(r.length)),n=r.map(function(e){return e.timestamp}),a=function(e){for(var t=e.getTime();n[0]!==t;)n.shift()},i=function(e,t){var r=t.findIndex(function(t){return t>=e});return -1===r?t:b(r+1,t)},s=[],f=!0,p=!1,m=void 0,_.label=1;case 1:_.trys.push([1,6,7,8]),h=function(){var e;return(0,c.YH)(this,function(t){switch(t.label){case 0:return e=g.value,[4,new Promise(function(t,c){queueMicrotask(function(){try{var f=function(e,t){(0,d.A)(2,arguments);var r,n,a=(0,l.A)(e);if(isNaN(Number(a)))return new Date(NaN);var i=a.getTime();return(null==t?[]:"function"==typeof t.forEach?t:Array.prototype.slice.call(t)).forEach(function(e){var t=(0,l.A)(e);if(isNaN(Number(t))){r=new Date(NaN),n=NaN;return}var a=Math.abs(i-t.getTime());(null==r||a<Number(n))&&(r=t,n=a)}),r}(e.date,i(e.date.getTime(),n));a(f);var p=r.find(function(e){return e.timestamp===f.getTime()}),m=(0,u._)((0,o._)({},e),{date:new Date(e.date),latitude:p.latitude,longitude:p.longitude,skip:Math.abs(p.timestamp-e.date.getTime())>6e4});return m.skip||s.push(m),t()}catch(e){return c(e)}})})];case 1:return t.sent(),[2]}})},v=t[Symbol.iterator](),_.label=2;case 2:if(f=(g=v.next()).done)return[3,5];return[5,(0,c.Ju)(h())];case 3:_.sent(),_.label=4;case 4:return f=!0,[3,2];case 5:return[3,8];case 6:return y=_.sent(),p=!0,m=y,[3,8];case 7:try{f||null==v.return||v.return()}finally{if(p)throw m}return[7];case 8:return[2,s]}})});return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,i._)(function(e){var t,r,n,a,i,o,u,l=arguments;return(0,c.YH)(this,function(c){switch(c.label){case 0:return t=(l.length>1&&void 0!==l[1]?l[1]:{}).omitPositions,n=(r=(0,s._)(e,2))[0],a=r[1],(0,p.V)(n,""),(0,p.V)(a,""),[4,Promise.all([(0,f.k8)(n).then(v),t?{records:[]}:(0,f.k8)(a).then(y)])];case 1:return o=(i=s._.apply(void 0,[c.sent(),2]))[0].records,u=i[1].records,[2,t?o:_({measures:o,positions:u})]}})});return function(t){return e.apply(this,arguments)}}(),N=function(e){return{type:"FeatureCollection",features:e.map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:e}})}},I=function(e){return w(e).then(N)},D="date",S=r(61760),k=r(56347),B=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173"],T="voc_ppb",x=[[0,2e3],[2e3,4e3],[4e3,6e3],[6e3,8e3],[8e3,1e4],[12e3,1e9]],E=["get",T],j=function(e){var t=e.isMinMaxDynamicRange,r=e.geojson,n=0,a=1/0,i=-1/0,o=!0,u=!1,s=void 0;try{for(var c,l=r.features[Symbol.iterator]();!(o=(c=l.next()).done);o=!0)(n=c.value.properties.pm_2_5)>i&&(i=n),n<a&&(a=n)}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}var d=B.length,f=t?(i-a)/d:0,p=t?(0,S._)(Array(d)).map(function(e,t){var r=a+t*f;return[r,r+f]}):x;return{circleCases:p.map((0,k.t)(E)).flatMap(function(e,t){return[e,B[t]]}),colors:B,fieldName:T,ranges:p}},A=function(){return{download:n,mapbox:a}}},69152:(e,t,r)=>{r.d(t,{V:()=>n});function n(e,t){if(null==e)throw Error(t)}}}]);