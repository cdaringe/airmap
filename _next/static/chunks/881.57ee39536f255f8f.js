"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[881],{22483:(e,t,r)=>{r.d(t,{A:()=>n});function n(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}},77031:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(70573),a=r(22483);function i(e){(0,a.A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||(void 0===e?"undefined":(0,n._)(e))==="object"&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(Error().stack)),new Date(NaN))}},53876:(e,t,r)=>{r.d(t,{DM:()=>u,k8:()=>s,zB:()=>o});var n=r(12551),a=r(61760),i=r(944);function o(e){try{var t=new URL(e),r=(0,n._)(t.pathname.substr(1).split("/"),3),a=r[0],i=r[1],o=r[2];if("spreadsheets"===a&&"d"===i&&o&&t.host.match("google.com"))return!0}catch(e){}return!1}function u(e){var t=new URL(e);return t.pathname=(0,a._)(t.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(t)}var s=function(e){var t=new URL(e),r=new URLSearchParams(t.search);return r.has("format")||r.set("format","csv"),t.search=r.toString(),(0,i.f)(u(t.toString()),{mode:"cors",redirect:"follow",headers:{accept:"text"}})}},66881:(e,t,r)=>{r.r(t),r.d(t,{getResources:()=>A});var n={};r.r(n),r.d(n,{combine:()=>w,dateField:()=>S,download:()=>_,downloadGeoJSON:()=>k,toGeoJSON:()=>N});var a={};r.r(a),r.d(a,{getLevels:()=>E});var i=r(48967),o=r(34618),u=r(92831),s=r(12551),c=r(65959),l=r(77031),f=r(22483),p=r(53876),d=r(69152),h=r(14952),m={voc_ppb:function(e){return parseInt(e)},date:function(e){return new Date(1e3*parseInt(e))},pm_2_5:function(e){return parseFloat(e)}},v=function(){var e=(0,i._)(function(e){var t,r,n,a,i,s,l=arguments;return(0,c.YH)(this,function(c){switch(c.label){case 0:return t=l.length>1&&void 0!==l[1]?l[1]:{records:[],partial:""},[4,e.read()];case 1:return n=(r=c.sent()).done,((a=r.value)||n)&&(t.partial+="string"==typeof a?a:a?new TextDecoder().decode(a):"",s=(i=t.partial.split(/\n/g)).length-1,i.forEach(function(e,r){if(s!==r||n){var a=e.split(",");if(t.headerIndiciesByName){var i="VOC (ppb)",c=a[t.headerIndiciesByName[i]],l=a[t.headerIndiciesByName.timestamp],f=a[t.headerIndiciesByName["pm 2.5 (ug/m3)"]];(0,d.V)(c,"voc missing (".concat(i,", value: ").concat(c,")")),(0,d.V)(l,"timestamp missing"),(0,d.V)(f,"pm25 missing"),t.records.push({voc_ppb:m.voc_ppb(c),date:m.date(l),pm_2_5:m.pm_2_5(f)}),n&&(t.partial="")}else t.headerIndiciesByName=a.reduce(function(e,t,r){return(0,u._)((0,o._)({},e),(0,h._)({},t.trim(),r))},{})}else t.partial=e})),[2,n?t:v(e,t)]}})});return function(t){return e.apply(this,arguments)}}(),y={timestamp:function(e){return 1e3*parseInt(e)},latitude:function(e){return parseFloat(e)},longitude:function(e){return parseFloat(e)}},g=function(){var e=(0,i._)(function(e){var t,r,n,a,i,s,l=arguments;return(0,c.YH)(this,function(c){switch(c.label){case 0:return t=l.length>1&&void 0!==l[1]?l[1]:{records:[],partial:""},[4,e.read()];case 1:return n=(r=c.sent()).done,((a=r.value)||n)&&(t.partial+="string"==typeof a?a:a?new TextDecoder().decode(a):"",s=(i=t.partial.split(/\n/g)).length-1,i.forEach(function(e,r){if(s!==r||n){var a=e.split(",");t.headerIndiciesByName?(t.records.push({timestamp:y.timestamp(a[t.headerIndiciesByName.timestamp]),latitude:y.latitude(a[t.headerIndiciesByName.latitude]),longitude:y.longitude(a[t.headerIndiciesByName.longitude])}),n&&(t.partial="")):t.headerIndiciesByName=a.reduce(function(e,t,r){return(0,u._)((0,o._)({},e),(0,h._)({},t.trim(),r))},{})}else t.partial=e})),[2,n?t:g(e,t)]}})});return function(t){return e.apply(this,arguments)}}(),b=function(e,t){for(var r=[],n=0;n<e;)r.push(t[n]),++n;return r},w=function(){var e=(0,i._)(function(e){var t,r,n,a,i,s,p,d,h,m,v,y,g;return(0,c.YH)(this,function(w){switch(w.label){case 0:t=e.measures,r=e.positions,t.length!==r.length&&console.warn("lossy data - measures ".concat(t.length,", positions ").concat(r.length)),n=r.map(function(e){return e.timestamp}),a=function(e){for(var t=e.getTime();n[0]!==t;)n.shift()},i=function(e,t){var r=t.findIndex(function(t){return t>=e});return -1===r?t:b(r+1,t)},s=[],p=!0,d=!1,h=void 0,w.label=1;case 1:w.trys.push([1,6,7,8]),m=function(){var e;return(0,c.YH)(this,function(t){switch(t.label){case 0:return e=y.value,[4,new Promise(function(t,c){queueMicrotask(function(){try{var p=function(e,t){(0,f.A)(2,arguments);var r,n,a=(0,l.A)(e);if(isNaN(Number(a)))return new Date(NaN);var i=a.getTime();return(null==t?[]:"function"==typeof t.forEach?t:Array.prototype.slice.call(t)).forEach(function(e){var t=(0,l.A)(e);if(isNaN(Number(t))){r=new Date(NaN),n=NaN;return}var a=Math.abs(i-t.getTime());(null==r||a<Number(n))&&(r=t,n=a)}),r}(e.date,i(e.date.getTime(),n));a(p);var d=r.find(function(e){return e.timestamp===p.getTime()}),h=(0,u._)((0,o._)({},e),{date:new Date(e.date),latitude:d.latitude,longitude:d.longitude,skip:Math.abs(d.timestamp-e.date.getTime())>6e4});return h.skip||s.push(h),t()}catch(e){return c(e)}})})];case 1:return t.sent(),[2]}})},v=t[Symbol.iterator](),w.label=2;case 2:if(p=(y=v.next()).done)return[3,5];return[5,(0,c.Ju)(m())];case 3:w.sent(),w.label=4;case 4:return p=!0,[3,2];case 5:return[3,8];case 6:return g=w.sent(),d=!0,h=g,[3,8];case 7:try{p||null==v.return||v.return()}finally{if(d)throw h}return[7];case 8:return[2,s]}})});return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,i._)(function(e){var t,r,n,a,i,o,u,l=arguments;return(0,c.YH)(this,function(c){switch(c.label){case 0:return t=(l.length>1&&void 0!==l[1]?l[1]:{}).omitPositions,n=(r=(0,s._)(e,2))[0],a=r[1],(0,d.V)(n,""),(0,d.V)(a,""),[4,Promise.all([(0,p.k8)(n).then(v),t?{records:[]}:(0,p.k8)(a).then(g)])];case 1:return o=(i=s._.apply(void 0,[c.sent(),2]))[0].records,u=i[1].records,[2,t?o:w({measures:o,positions:u})]}})});return function(t){return e.apply(this,arguments)}}(),N=function(e){return{type:"FeatureCollection",features:e.map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:e}})}},k=function(e){return _(e).then(N)},S="date",x=r(61760),I=r(33925),D=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173"],B="voc_ppb",T=[[0,2e3],[2e3,4e3],[4e3,6e3],[6e3,8e3],[8e3,1e4],[12e3,1e9]],j=["get",B],E=function(e){var t=e.isMinMaxDynamicRange,r=e.geojson,n=0,a=1/0,i=-1/0,o=!0,u=!1,s=void 0;try{for(var c,l=r.features[Symbol.iterator]();!(o=(c=l.next()).done);o=!0)(n=c.value.properties.pm_2_5)>i&&(i=n),n<a&&(a=n)}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}var f=D.length,p=t?(i-a)/f:0,d=t?(0,x._)(Array(f)).map(function(e,t){var r=a+t*p;return[r,r+p]}):T;return{circleCases:d.map((0,I.t3)(j)).flatMap(function(e,t){return[e,D[t]]}),colors:D,fieldName:B,ranges:d}},A=function(){return{download:n,mapbox:a}}},944:(e,t,r)=>{function n(e){this.wrapped=e}function a(e){var t,r;function a(t,r){try{var o=e[t](r),u=o.value,s=u instanceof n;Promise.resolve(s?u.wrapped:u).then(function(e){if(s){a("next",e);return}i(o.done?"return":"normal",e)},function(e){a("throw",e)})}catch(e){i("throw",e)}}function i(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?a(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(i,o){var u={key:e,arg:n,resolve:i,reject:o,next:null};r?r=r.next=u:(t=r=u,a(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}r.d(t,{f:()=>u,S:()=>s}),"function"==typeof Symbol&&Symbol.asyncIterator&&(a.prototype[Symbol.asyncIterator]=function(){return this}),a.prototype.next=function(e){return this._invoke("next",e)},a.prototype.throw=function(e){return this._invoke("throw",e)},a.prototype.return=function(e){return this._invoke("return",e)};var i=r(65959),o=r(69152),u=function(e,t){return fetch(e,t).then(function(e){return e.body}).then(function(e){var t=null==e?void 0:e.getReader();return(0,o.V)(t,"missing stream body"),t})};function s(e){return c.apply(this,arguments)}function c(){var e;return e=function(e){var t,r,a,o,u,s,c,l,f,p,d,h,m;return(0,i.YH)(this,function(i){switch(i.label){case 0:t=new TextDecoder,r="",i.label=1;case 1:return[4,new n(e.read())];case 2:if(o=(a=i.sent()).done,u=a.value,!o)return[3,5];if(!r)return[3,4];return[4,r];case 3:i.sent(),i.label=4;case 4:return[3,14];case 5:r+=t.decode(u,{stream:!0}),r=null!==(c=(s=r.split("\n")).pop())&&void 0!==c?c:"",l=!0,f=!1,p=void 0,i.label=6;case 6:i.trys.push([6,11,12,13]),d=s[Symbol.iterator](),i.label=7;case 7:if(l=(h=d.next()).done)return[3,10];return[4,h.value];case 8:i.sent(),i.label=9;case 9:return l=!0,[3,7];case 10:return[3,13];case 11:return m=i.sent(),f=!0,p=m,[3,13];case 12:try{l||null==d.return||d.return()}finally{if(f)throw p}return[7];case 13:return[3,1];case 14:return[2]}})},(c=function(){return new a(e.apply(this,arguments))}).apply(this,arguments)}},69152:(e,t,r)=>{r.d(t,{V:()=>n});function n(e,t){if(null==e)throw Error(t)}}}]);