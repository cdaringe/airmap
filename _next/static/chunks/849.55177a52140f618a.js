"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{4849:function(r,e,n){function t(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=[],t=!0,a=!1,i=void 0;try{for(var u,o=r[Symbol.iterator]();!(t=(u=o.next()).done)&&(n.push(u.value),!e||n.length!==e);t=!0);}catch(c){a=!0,i=c}finally{try{t||null==o.return||o.return()}finally{if(a)throw i}}return n}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,{q:function(){return a}});var a=function(r){return function(e){var n=t(e,2),a=n[0],i=n[1];return["all",[">=",r,a],["<",r,i]]}}},7849:function(r,e,n){n.r(e),n.d(e,{getResources:function(){return v}});var t={};n.r(t),n.d(t,{getLevels:function(){return m},getLevelsByField:function(){return s},makeGetLevels:function(){return f}});var a=n(4849);function i(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function u(r){return function(r){if(Array.isArray(r)){for(var e=0,n=new Array(r.length);e<r.length;e++)n[e]=r[e];return n}}(r)||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o,c=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173","black"],l=[0,.25,.5,1,2.5,5,20].map((function(r,e,n){return[r,n[e+1]||1/0]})),f=function(r){return function(e){var n=e.isMinMaxDynamicRange,t=e.geojson,i=0,o=1/0,f=-1/0,s=!0,m=!1,d=void 0;try{for(var p,v=t.features[Symbol.iterator]();!(s=(p=v.next()).done);s=!0){(i=p.value.properties[r])>f&&(f=i),i<o&&(o=i)}}catch(b){m=!0,d=b}finally{try{s||null==v.return||v.return()}finally{if(m)throw d}}var h=c.length,y=n?(f-o)/h:0,g=n?u(new Array(h)).map((function(r,e){var n=o+e*y;return[n,n+y]})):l;return{circleCases:g.map((0,a.q)(["get",r])).flatMap((function(r,e){return[r,c[e]]})),colors:c,fieldName:r,ranges:g}}},s=(i(o={},"PM0.5 \u03bcg/m^3 (derived)",f("pm05Derived")),i(o,"PM0.5 \u03bcg/m^3 (naive)",f("pm05Naive")),i(o,"PM2.5 \u03bcg/m^3",f("pm_2_5")),i(o,"PM0.5 \u03bcg/m^3 (calibrated)",f("pm05Calibrated")),i(o,"PM0.5-3 \u03bcg/m^3 (calibrated)",f("pm05To3Calibrated")),o),m=s["PM0.5 \u03bcg/m^3 (derived)"],d=n(1321);function p(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var v=function(){return function(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),t.forEach((function(e){p(r,e,n[e])}))}return r}({},{mapbox:t},{stream:d})}},1321:function(r,e,n){n.r(e),n.d(e,{RHO_GRIMM:function(){return l},parse:function(){return g},sum:function(){return s},"toPartial\u03bcgPerM3":function(){return p},"toPartial\u03bcgPerM3SansRho":function(){return v}});var t=n(4235),a=n.n(t),i=n(6930);function u(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=[],t=!0,a=!1,i=void 0;try{for(var u,o=r[Symbol.iterator]();!(t=(u=o.next()).done)&&(n.push(u.value),!e||n.length!==e);t=!0);}catch(c){a=!0,i=c}finally{try{t||null==o.return||o.return()}finally{if(a)throw i}}return n}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(r,e,n,t,a,i,u){try{var o=r[i](u),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(t,a)}var c,l=1800,f=[6.842765,7.1751666,7.0114602,6.9088991,7.0263146,6.9180838,7.0393966,6.989318,6.9812267,5.2701795,14.0655402,13.8262107,14.1929174,14.0017841,13.8883794,13.9963284,14.0409634,14.2779903,13.8513492,13.898864,13.6873067,14.3390373,13.8184393,14.1478588,14.0655395,13.8262102,14.1929179,13.8296286,14.062005,13.9963317,14.040958,14.001345,13.96783,14,13.95533,14.00924,14,14,14,14,14],s=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return e.reduce((function(r,e){return r+e}),0)},m=function(r){return r/1e9},d=function(r){return 1e6*r},p=function(r,e,n,t){return d(r)/f[n]*(Math.PI/6)*Math.pow(m(e),3)*t*1e9},v=function(r,e,n){return d(r)/f[n]*(Math.PI/6)*Math.pow(m(e),3)*1e9},h=function(r){return new Date(r.trim().split(" ").map((function(r,e){if(0===e){var n=u(r.split("/"),3),t=n[0],a=n[1],i=n[2],o=function(r){return 1===r.length?"0".concat(r):r};return"".concat(t,"-").concat(o(a),"-").concat(o(i))}return"T".concat(r,".000+01:00")})).join(""))},y=function(r){var e=parseFloat(r);return Number.isNaN(e)?(console.error("Expected a number, got a NaN. MiniWras export problem?"),0):e},g=(c=a().mark((function r(e,n){var t,u,o,c,f,s,m;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=void 0===n?{records:[],partial:"",particleDiametersAscending:[]}:n,r.next=3,e.read();case 3:return u=r.sent,o=u.done,((c=u.value)||o)&&(t.partial+="string"===typeof c?c:c?(new TextDecoder).decode(c):"",f=t.partial.split(/\n/g),s=f.map((function(r){return r.trim()})).filter((function(r){return!!r})),m=s.length-1,s.forEach((function(r,e){if(m!==e||o){var n=r.includes(",")?r.split(","):r.split("\t");if(t.headerIndiciesByName){var a=n[t.headerIndiciesByName.Time],u=n[t.headerIndiciesByName["pm2.5 [ug/m3]"]];(0,i.k)(a,"date missing"),(0,i.k)(Number.isFinite(u),"column 'pm2.5 [ug/m3]' missing");for(var c=0,f=t.headerIndiciesByName["10.00 nm"],s=t.headerIndiciesByName["449.48 nm"],d=t.headerIndiciesByName["3238.77 nm"],v=[],g=0,b={sub500nm:[],sub3000nm:[]};f<d;){var w=parseFloat(n[f]),N=(t.particleDiametersAscending[g]+t.particleDiametersAscending[g+1])/2,M={value:w,diameterMidpointNm:N,calibrationIndex:g},P=p(w,N,g,l);f<s&&(b.sub500nm.push(M),c+=P),f<d&&b.sub3000nm.push(M),++f,++g}console.log({sampleNum:t.records.length,pm05:c,debug:v}),t.records.push({channels:b,date:h(a),debug:v,pm05EndCol:s,pm05Naive:c,pm_2_5:y(u)}),o&&(t.partial="")}else t.headerCells=n,t.headerIndiciesByName=n.reduce((function(r,e,n){var a=e.trim();r[a]=n;var i=a.match(/\s*(\d+\.\d+)\s+nm/);return i&&t.particleDiametersAscending.push(parseInt(i[1],10)),r}),{})}else t.partial=r}))),r.abrupt("return",o?t:g(e,t));case 8:case"end":return r.stop()}}),r)})),function(){var r=this,e=arguments;return new Promise((function(n,t){var a=c.apply(r,e);function i(r){o(a,n,t,i,u,"next",r)}function u(r){o(a,n,t,i,u,"throw",r)}i(void 0)}))})},6930:function(r,e,n){function t(r,e){if(null===r||void 0===r)throw Error(e)}n.d(e,{k:function(){return t}})}}]);