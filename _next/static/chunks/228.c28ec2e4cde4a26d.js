"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[228],{1988:function(e,t,r){r.d(t,{Ok:function(){return i},Hw:function(){return c},e5:function(){return u}});var n=r(5624);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e){try{var t=new URL(e),r=o(t.pathname.substr(1).split("/"),3),n=r[0],a=r[1],i=r[2];if("spreadsheets"===n&&"d"===a&&i&&t.host.match("google.com"))return!0}catch(u){}return!1}function u(e){var t=new URL(e);return t.pathname=a(t.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(t)}var c=function(e){var t=new URL(e),r=new URLSearchParams(t.search);return r.has("format")||r.set("format","csv"),t.search=r.toString(),function(e,t){return fetch(e,t).then((function(e){return e.body})).then((function(e){var t=null===e||void 0===e?void 0:e.getReader();return(0,n.k)(t,"missing stream body"),t}))}(u(t.toString()),{mode:"cors",redirect:"follow",headers:{accept:"text"}})}},8677:function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.d(t,{q:function(){return o}});var o=function(e){return function(t){var r=n(t,2),o=r[0],a=r[1];return["all",[">=",e,o],["<",e,a]]}}},1228:function(e,t,r){r.r(t),r.d(t,{getResources:function(){return D}});var n={};r.r(n),r.d(n,{getLevels:function(){return R}});var o=r(4235),a=r.n(o),i=r(1988),u=r(5624);function c(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(f){return void r(f)}u.done?t(c):Promise.resolve(c).then(n,o)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){f(e,t,r[t])}))}return e}var l,p=function(e){return parseInt(e)},d=function(e){return 1e3*parseInt(e)},m=function(e){return parseFloat(e)},y=(l=a().mark((function e(t,r){var n,o,i,c,l,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===r?{records:[],partial:""}:r,e.next=3,t.read();case 3:return o=e.sent,i=o.done,((c=o.value)||i)&&(n.partial+="string"===typeof c?c:c?(new TextDecoder).decode(c):"",l=n.partial.split(/\n/g),v=l.length-1,l.forEach((function(e,t){if(v!==t||i){var r=e.split(",");if(n.headerIndiciesByName){var o="VOC (ppb)",a=r[n.headerIndiciesByName["VOC (ppb)"]],c=r[n.headerIndiciesByName.timestamp],l=r[n.headerIndiciesByName["pm 2.5 (ug/m3)"]];(0,u.k)(a,"voc missing (".concat(o,", value: ").concat(a,")")),(0,u.k)(c,"timestamp missing"),(0,u.k)(l,"pm25 missing"),n.records.push({voc_ppb:p(a),timestamp:d(c),pm_2_5:m(l)}),i&&(n.partial="")}else n.headerIndiciesByName=r.reduce((function(e,t,r){return s({},e,f({},t.trim(),r))}),{})}else n.partial=e}))),e.abrupt("return",i?n:y(t,n));case 8:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(r,n){var o=l.apply(e,t);function a(e){c(o,r,n,a,i,"next",e)}function i(e){c(o,r,n,a,i,"throw",e)}a(void 0)}))});function v(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(f){return void r(f)}u.done?t(c):Promise.resolve(c).then(n,o)}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){h(e,t,r[t])}))}return e}var g=function(e){return 1e3*parseInt(e)},w=function(e){return parseFloat(e)},O=function(e){return parseFloat(e)},j=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){v(a,n,o,i,u,"next",e)}function u(e){v(a,n,o,i,u,"throw",e)}i(void 0)}))}}(a().mark((function e(t,r){var n,o,i,u,c,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===r?{records:[],partial:""}:r,e.next=3,t.read();case 3:return o=e.sent,i=o.done,((u=o.value)||i)&&(n.partial+="string"===typeof u?u:u?(new TextDecoder).decode(u):"",c=n.partial.split(/\n/g),f=c.length-1,c.forEach((function(e,t){if(f!==t||i){var r=e.split(",");n.headerIndiciesByName?(n.records.push({timestamp:g(r[n.headerIndiciesByName.timestamp]),latitude:w(r[n.headerIndiciesByName.latitude]),longitude:O(r[n.headerIndiciesByName.longitude])}),i&&(n.partial="")):n.headerIndiciesByName=r.reduce((function(e,t,r){return b({},e,h({},t.trim(),r))}),{})}else n.partial=e}))),e.abrupt("return",i?n:j(t,n));case 8:case"end":return e.stop()}}),e)})));function P(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(f){return void r(f)}u.done?t(c):Promise.resolve(c).then(n,o)}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){k(e,t,r[t])}))}return e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var I=function(e){var t=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){P(a,n,o,i,u,"next",e)}function u(e){P(a,n,o,i,u,"throw",e)}i(void 0)}))}}(a().mark((function t(r){var n,o,c,f,s,l,p,d,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=x(r,2),o=n[0],c=n[1],(0,u.k)(o,""),(0,u.k)(c,""),t.t0=x,t.next=6,Promise.all([(0,i.Hw)(o).then(y),(0,i.Hw)(c).then(j)]);case 6:return t.t1=t.sent,f=(0,t.t0)(t.t1,2),s=f[0],l=s.records,p=f[1],d=p.records,l.length!==d.length&&console.warn("lossy data - measures ".concat(l.length,", positions ").concat(d.length)),m=d.map((function(e){return e.timestamp})),t.abrupt("return",l.reduce((function(t,r){var n=e.closestTo(r.timestamp,m),o=d.find((function(e){return e.timestamp===n.getTime()})),a=S({},r,{date:new Date(o.timestamp),latitude:o.latitude,longitude:o.longitude,skip:Math.abs(o.timestamp-r.timestamp)>6e4});return a.skip||t.push(a),t}),[]));case 15:case"end":return t.stop()}}),t)}))),r=function(e){return{type:"FeatureCollection",features:e.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:S({},e)}}))}};return{download:t,downloadGeoJSON:function(e){return t(e).then(r)},dateField:"date",toGeoJSON:r}},A=r(8677);function N(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var E=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173"],B="voc_ppb",_=[[0,2e3],[2e3,4e3],[4e3,6e3],[6e3,8e3],[8e3,1e4],[12e3,1e9]],T=["get",B],R=function(e){var t=e.isMinMaxDynamicRange,r=e.geojson,n=0,o=1/0,a=-1/0,i=!0,u=!1,c=void 0;try{for(var f,s=r.features[Symbol.iterator]();!(i=(f=s.next()).done);i=!0){(n=f.value.properties.pm_2_5)>a&&(a=n),n<o&&(o=n)}}catch(m){u=!0,c=m}finally{try{i||null==s.return||s.return()}finally{if(u)throw c}}var l=E.length,p=t?(a-o)/l:0,d=t?N(new Array(l)).map((function(e,t){var r=o+t*p;return[r,r+p]})):_;return{circleCases:d.map((0,A.q)(T)).flatMap((function(e,t){return[e,E[t]]})),colors:E,fieldName:B,pm2Ranges:d}},D=function(e){return{download:I(e),mapbox:n}}},5624:function(e,t,r){function n(e,t){if(null===e||void 0===e)throw Error(t)}r.d(t,{k:function(){return n}})}}]);