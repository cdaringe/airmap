"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[339],{2454:function(e,r,t){t.d(r,{Ok:function(){return i},Hw:function(){return c},e5:function(){return u}});var n=t(6930);function o(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e){try{var r=new URL(e),t=o(r.pathname.substr(1).split("/"),3),n=t[0],a=t[1],i=t[2];if("spreadsheets"===n&&"d"===a&&i&&r.host.match("google.com"))return!0}catch(u){}return!1}function u(e){var r=new URL(e);return r.pathname=a(r.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(r)}var c=function(e){var r=new URL(e),t=new URLSearchParams(r.search);return t.has("format")||t.set("format","csv"),r.search=t.toString(),function(e,r){return fetch(e,r).then((function(e){return e.body})).then((function(e){var r=null===e||void 0===e?void 0:e.getReader();return(0,n.k)(r,"missing stream body"),r}))}(u(r.toString()),{mode:"cors",redirect:"follow",headers:{accept:"text"}})}},4849:function(e,r,t){function n(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.d(r,{q:function(){return o}});var o=function(e){return function(r){var t=n(r,2),o=t[0],a=t[1];return["all",[">=",e,o],["<",e,a]]}}},339:function(e,r,t){t.r(r),t.d(r,{getResources:function(){return C}});var n={};t.r(n),t.d(n,{getLevels:function(){return R}});var o=t(4235),a=t.n(o),i=t(2454),u=t(6930);function c(e,r,t,n,o,a,i){try{var u=e[a](i),c=u.value}catch(s){return void t(s)}u.done?r(c):Promise.resolve(c).then(n,o)}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function f(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){s(e,r,t[r])}))}return e}var l,p=function(e){return parseInt(e)},d=function(e){return new Date(1e3*parseInt(e))},v=function(e){return parseFloat(e)},m=(l=a().mark((function e(r,t){var n,o,i,c,l,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===t?{records:[],partial:""}:t,e.next=3,r.read();case 3:return o=e.sent,i=o.done,((c=o.value)||i)&&(n.partial+="string"===typeof c?c:c?(new TextDecoder).decode(c):"",l=n.partial.split(/\n/g),h=l.length-1,l.forEach((function(e,r){if(h!==r||i){var t=e.split(",");if(n.headerIndiciesByName){var o="VOC (ppb)",a=t[n.headerIndiciesByName["VOC (ppb)"]],c=t[n.headerIndiciesByName.timestamp],l=t[n.headerIndiciesByName["pm 2.5 (ug/m3)"]];(0,u.k)(a,"voc missing (".concat(o,", value: ").concat(a,")")),(0,u.k)(c,"timestamp missing"),(0,u.k)(l,"pm25 missing"),n.records.push({voc_ppb:p(a),date:d(c),pm_2_5:v(l)}),i&&(n.partial="")}else n.headerIndiciesByName=t.reduce((function(e,r,t){return f({},e,s({},r.trim(),t))}),{})}else n.partial=e}))),e.abrupt("return",i?n:m(r,n));case 8:case"end":return e.stop()}}),e)})),function(){var e=this,r=arguments;return new Promise((function(t,n){var o=l.apply(e,r);function a(e){c(o,t,n,a,i,"next",e)}function i(e){c(o,t,n,a,i,"throw",e)}a(void 0)}))});function h(e,r,t,n,o,a,i){try{var u=e[a](i),c=u.value}catch(s){return void t(s)}u.done?r(c):Promise.resolve(c).then(n,o)}function y(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){y(e,r,t[r])}))}return e}var g=function(e){return 1e3*parseInt(e)},w=function(e){return parseFloat(e)},O=function(e){return parseFloat(e)},x=function(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function i(e){h(a,n,o,i,u,"next",e)}function u(e){h(a,n,o,i,u,"throw",e)}i(void 0)}))}}(a().mark((function e(r,t){var n,o,i,u,c,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===t?{records:[],partial:""}:t,e.next=3,r.read();case 3:return o=e.sent,i=o.done,((u=o.value)||i)&&(n.partial+="string"===typeof u?u:u?(new TextDecoder).decode(u):"",c=n.partial.split(/\n/g),s=c.length-1,c.forEach((function(e,r){if(s!==r||i){var t=e.split(",");n.headerIndiciesByName?(n.records.push({timestamp:g(t[n.headerIndiciesByName.timestamp]),latitude:w(t[n.headerIndiciesByName.latitude]),longitude:O(t[n.headerIndiciesByName.longitude])}),i&&(n.partial="")):n.headerIndiciesByName=t.reduce((function(e,r,t){return b({},e,y({},r.trim(),t))}),{})}else n.partial=e}))),e.abrupt("return",i?n:x(r,n));case 8:case"end":return e.stop()}}),e)}))),k=function(e,r){for(var t=[],n=0;n<e;)t.push(r[n]),++n;return t};function j(e,r,t,n,o,a,i){try{var u=e[a](i),c=u.value}catch(s){return void t(s)}u.done?r(c):Promise.resolve(c).then(n,o)}function P(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function i(e){j(a,n,o,i,u,"next",e)}function u(e){j(a,n,o,i,u,"throw",e)}i(void 0)}))}}function S(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function I(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){S(e,r,t[r])}))}return e}function A(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(c){o=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var N=t(4849);function E(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var T=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173"],B="voc_ppb",_=[[0,2e3],[2e3,4e3],[4e3,6e3],[6e3,8e3],[8e3,1e4],[12e3,1e9]],D=["get",B],R=function(e){var r=e.isMinMaxDynamicRange,t=e.geojson,n=0,o=1/0,a=-1/0,i=!0,u=!1,c=void 0;try{for(var s,f=t.features[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){(n=s.value.properties.pm_2_5)>a&&(a=n),n<o&&(o=n)}}catch(v){u=!0,c=v}finally{try{i||null==f.return||f.return()}finally{if(u)throw c}}var l=T.length,p=r?(a-o)/l:0,d=r?E(new Array(l)).map((function(e,r){var t=o+r*p;return[t,t+p]})):_;return{circleCases:d.map((0,N.q)(D)).flatMap((function(e,r){return[e,T[r]]})),colors:T,fieldName:B,ranges:d}},C=function(e){return{download:function(e){var r=P(a().mark((function e(r){var t,n,o,i,u,c,s,f,l,p,d,v,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.measures,n=r.positions,o=r.r,t.length!==n.length&&console.warn("lossy data - measures ".concat(t.length,", positions ").concat(n.length)),i=n.map((function(e){return e.timestamp})),u=function(e){for(var r=e.getTime();i[0]!==r;)i.shift()},c=function(e,r){var t=r.findIndex((function(r){return r>=e}));return-1===t?r:k(t+1,r)},s=[],f=!0,l=!1,p=void 0,e.prev=7,d=t[Symbol.iterator]();case 9:if(f=(v=d.next()).done){e.next=16;break}return m=v.value,e.next=13,new Promise((function(e,r){queueMicrotask((function(){try{var t=o.closestTo(m.date,c(m.date.getTime(),i));u(t);var a=n.find((function(e){return e.timestamp===t.getTime()})),f=I({},m,{date:new Date(m.date),latitude:a.latitude,longitude:a.longitude,skip:Math.abs(a.timestamp-m.date.getTime())>6e4});return f.skip||s.push(f),e()}catch(l){return r(l)}}))}));case 13:f=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),l=!0,p=e.t0;case 22:e.prev=22,e.prev=23,f||null==d.return||d.return();case 25:if(e.prev=25,!l){e.next=28;break}throw p;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",s);case 31:case"end":return e.stop()}}),e,null,[[7,18,22,30],[23,,25,29]])}))),t=P(a().mark((function t(n,o){var c,s,f,l,p,d,v,h,y;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=(void 0===o?{}:o).omitPositions,s=A(n,2),f=s[0],l=s[1],(0,u.k)(f,""),(0,u.k)(l,""),t.t0=A,t.next=7,Promise.all([(0,i.Hw)(f).then(m),c?{records:[]}:(0,i.Hw)(l).then(x)]);case 7:return t.t1=t.sent,p=(0,t.t0)(t.t1,2),d=p[0],v=d.records,h=p[1],y=h.records,t.abrupt("return",c?v:r({measures:v,positions:y,r:e}));case 14:case"end":return t.stop()}}),t)}))),n=function(e){return{type:"FeatureCollection",features:e.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:I({},e)}}))}};return{combine:r,download:t,downloadGeoJSON:function(e){return t(e).then(n)},dateField:"date",toGeoJSON:n}}(e),mapbox:n}}},6930:function(e,r,t){function n(e,r){if(null===e||void 0===e)throw Error(r)}t.d(r,{k:function(){return n}})}}]);