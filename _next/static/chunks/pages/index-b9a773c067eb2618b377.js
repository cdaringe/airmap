(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3988:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var n=t(9899);var o=t(641);function c(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||(0,o.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},3245:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return E}});var n=t(4637),o=t(1384),c=(t(9496),t(7592));function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var s,u=function(e){var r=e.className,t=(0,c.Z)(e,["className"]);return(0,n.jsx)("select",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({className:"block text-gray-700 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ".concat(r||"")},t))};function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}!function(e){e.googlesheetsurl="googlesheetsurl",e.csvurl="csvurl"}(s||(s={}));var p=function(e){return(0,n.jsxs)(u,l(l({},e),{},{children:[(0,n.jsx)("option",{value:s.googlesheetsurl,children:"Google Sheets URL"}),(0,n.jsx)("option",{value:s.csvurl,children:"CSV URL"})]}))},f=t(1626);function b(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var g=function(e){var r=e.error,t=e.className,a=(0,c.Z)(e,["error","className"]);return(0,n.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?b(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({className:(0,f.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,t)},a))},y=function(e){var r=e.datasource,t=e.url,o=e.onDatasourceSourceChange,c=e.isRenderingUrlErrorState,a=e.onUrlChange;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"gray-200 text-gray-600 text-center",children:"Enter your datasource"}),(0,n.jsx)(p,{className:"w-full mt-1",value:r,onChange:o}),(0,n.jsx)(g,{error:c,className:"w-full mt-1 w-full",placeholder:"https://url/to/data",defaultValue:t,onChange:a}),c?(0,n.jsxs)("p",{className:"text-red-600 text-left text-sm",children:["Sheets URL must have the form:",(0,n.jsx)("br",{}),"https://docs.google.com/spreadsheets/d/:id/gviz/tq"]}):null]})},O=t(3988),d=t(2468);function h(e){try{var r=new URL(e),t=r.pathname.substr(1).split("/"),n=(0,d.Z)(t,3),o=n[0],c=n[1],a=n[2];if("spreadsheets"===o&&"d"===c&&a&&r.host.match("google.com"))return!0}catch(s){}return!1}function j(e){if(!h(e))throw new Error("url incompatible ".concat(e));var r=new URL(e);return r.pathname=[].concat((0,O.Z)(r.pathname.substr(1).split("/").splice(0,3)),["gviz","tq"]).join("/"),String(r)}var m=t(419),v=t(4942);function w(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var P="bg-gray-600 hover:bg-gray-700",x=function(e){var r=e.bg,t=void 0===r?P:r,a=e.type,s=void 0===a?"button":a,u=e.className,i=(0,c.Z)(e,["bg","type","className"]),l=(0,f.Z)(u,t,"py-2 px-4 flex justify-center items-center focus:ring-gray-500 focus:ring-offset-gray-200 text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg");return(0,n.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?w(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({type:s,className:l},i))},D=t(8047);function S(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function N(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?S(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function E(){var e=(0,m.wl)(),r=e.value,t=r.url,o=r.datasource,c=e.update,a=(0,D.jU)(),s=a.value.accessToken,u=(a.update,function(e){var r;try{r=new URL(e)}catch(t){return!1}return"http:"===r.protocol||"https:"===r.protocol}(t)&&t.match("gviz/tq")),i=u||h(t),l=(0,v.useRouter)(),p=!(!t||i),f=!i||!s;return(0,n.jsxs)("form",{className:"content home w-96 max-w-screen-md",onSubmit:function(e){return e.preventDefault()},children:[(0,n.jsx)("h1",{className:"text-4xl text-center",children:"airmap!"}),(0,n.jsx)(y,N({},{datasource:o,onDatasourceSourceChange:function(e){c({url:t,datasource:e.currentTarget.value})},isRenderingUrlErrorState:p,onUrlChange:function(e){c({url:e.currentTarget.value,datasource:o})},url:t})),(0,n.jsx)(x,{disabled:f,className:"block m-auto mt-2",bg:f?"bg-gray-300":P,onClick:function(e){if(f)e.preventDefault();else{var r=h(t);!u&&r&&c({datasource:o,url:j(t)}),l.push("/map")}},children:"Submit"})]})}},3583:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3245)}])}},function(e){e.O(0,[888,179],(function(){return r=3583,e(e.s=r);var r}));var r=e.O();_N_E=r}]);