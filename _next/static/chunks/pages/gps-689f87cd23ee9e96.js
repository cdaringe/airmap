(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{9766:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gps",function(){return n(343)}])},343:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return g}});var t=n(4235),o=n.n(t),i=n(1250),u=n(9901),a=n(1804),c=n(1750);function s(e,r,n,t,o,i,u){try{var a=e[i](u),c=a.value}catch(s){return void n(s)}a.done?r(c):Promise.resolve(c).then(t,o)}function l(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function f(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=[],t=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(t=(u=a.next()).done)&&(n.push(u.value),!r||n.length!==r);t=!0);}catch(c){o=!0,i=c}finally{try{t||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(e){var r=e.fn,n=e.timeoutRef,t=e.duration,o=void 0===t?3e4:t,i=e.leadingEdge,u=void 0===i||i,a=e.isRecordingPausedRef;n.current=window.setTimeout((function(){return((null===a||void 0===a?void 0:a.current)?Promise.resolve():r()).finally((function(){Number.isFinite(n.current)&&b(function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){l(e,r,n[r])}))}return e}({},e,{leadingEdge:!1}))}))}),u?0:o)}function g(){var e,r=u.useRef(null),n=u.useRef(null),t=f(u.useState(!1),2),l=t[0],g=t[1],d=f(u.useState(1e4),2),p=d[0],y=d[1],m=u.useRef(l),v=u.useCallback((function(){m.current=!m.current,g(m.current)}),[g]),h=f(u.useState((new Date).getTime()),2),w=(h[0],h[1]),O=f(u.useState(""),2),j=O[0],k=O[1],x=f(u.useState(""),2),P=x[0],S=x[1],N=u.useCallback((e=o().mark((function e(){var n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w((function(e){return e+1})),e.prev=1,e.next=4,new Promise((function(e,r){return navigator.geolocation.getCurrentPosition(e,r,{enableHighAccuracy:!1,timeout:5e3,maximumAge:0})}));case 4:if(n=e.sent,t=r.current){e.next=8;break}throw new Error("missing pre el");case 8:t.innerHTML+=[new Date(n.timestamp).toISOString(),n.coords.latitude,n.coords.longitude].map((function(e){return e.toString()})).join(",")+"\n",e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),k(String(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})),function(){var r=this,n=arguments;return new Promise((function(t,o){var i=e.apply(r,n);function u(e){s(i,t,o,u,a,"next",e)}function a(e){s(i,t,o,u,a,"throw",e)}u(void 0)}))}),[]),E=u.useCallback((function(){var e=r.current;e&&(e.innerHTML="timestamp,latitude,longitude\n",b({fn:N,timeoutRef:n,duration:p,isRecordingPausedRef:m}))}),[n,N,p]),C=f(u.useState(3),2),_=C[0],R=C[1],T=u.useCallback((function(){var e=function(){return R(3)},r=_-1;if(r){R(r);var t=setTimeout(e,2e3);return function(){return clearTimeout(t)}}clearTimeout(n.current),n.current=null,w(0),e()}),[_]),I=Number.isFinite(n.current);return u.useEffect((function(){var e=function(e){return S(["Warning: WakeLock error. WakeLock helps your phone stay awake while it's polling GPS data. It is not required, but helps keep data flowing reliably. This generally happens when not using Google Chrome, using Apple devices, low battery, or permissions issues. We will proceed without it.",e].filter(Boolean).join("\n\n"))};try{var r=navigator.wakeLock;if(!r)throw new Error("no wake lock");if(!I)return;r.request("screen").then((function(){}),(function(r){return e(String(r))}))}catch(n){e("If you have issues, try Google Chrome.")}}),[j,k,I]),(0,i.jsxs)("div",{className:"p-2",children:[(0,i.jsx)(a.Z,{disabled:m.current,styles:{bg:I?"bg-red-600 hover:bg-red-700 focus:ring-red-500 focus:ring-offset-red-200":"bg-green-600 hover:bg-green-700 focus:ring-green-500 focus:ring-offset-green-200",display:"inline-block"},className:"mr-1",onClick:function(){I?T():E()},children:I?"Stop".concat(3===_?"":" (Confirm quickly, ".concat(_,"x clicks)")):"Start"}),(0,i.jsx)(a.Z,{disabled:!I,styles:{bg:"bg-orange-600 hover:bg-orange-700 focus:ring-orange-500 focus:ring-offset-orange-200",display:"inline-block"},className:"mr-1",onClick:function(){return v()},children:m.current?"Resume":"Pause"}),(0,i.jsx)(a.Z,{styles:{bg:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 focus:ring-offset-blue-200",display:"inline-block"},className:"mr-1",onClick:function(){var e,n=(null===(e=r.current)||void 0===e?void 0:e.textContent)||"",t=document.createElement("a");t.download="gps_data_".concat((new Date).toISOString(),".csv");var o=new Blob([n],{type:"text/csv"});t.href=window.URL.createObjectURL(o),t.click()},children:"Export"}),(0,i.jsx)("label",{htmlFor:"durationMs",children:"Interval (ms)"}),(0,i.jsx)(c.Z,{className:"mb-2",type:"number",name:"durationMs",value:p,disabled:I,onChange:function(e){var r=parseInt(e.currentTarget.value,10);Number.isInteger(r)&&y(r)}}),j?(0,i.jsx)("pre",{className:"w-full p-2 mb-1 bg-red-200 border border-red-500 rounded",children:j}):null,P?(0,i.jsx)("pre",{className:"w-full p-2 mb-1 whitespace-pre-line bg-orange-200 border border-orange-500 rounded",children:P}):null,(0,i.jsx)("pre",{className:"block",ref:r})]})}},1804:function(e,r,n){"use strict";var t=n(1250),o=n(5789);n(9901);function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function u(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var a="bg-gray-600 hover:bg-gray-700 focus:ring-gray-500 focus:ring-offset-gray-200",c="flex";r.Z=function(e){var r=e.styles,n=void 0===r?{}:r,s=n.bg,l=void 0===s?a:s,f=n.display,b=void 0===f?c:f,g=e.type,d=void 0===g?"button":g,p=e.className,y=u(e,["styles","type","className"]),m=(0,o.Z)(p,l,b,"py-2 px-4 justify-center items-center text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg",y.disabled?"bg-gray-400 hover:bg-gray-400 cursor-not-allowed":"");return(0,t.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){i(e,r,n[r])}))}return e}({type:d,className:m},y))}},1750:function(e,r,n){"use strict";var t=n(1250),o=(n(9901),n(5789));function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function u(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}r.Z=function(e){var r=e.error,n=e.className,a=u(e,["error","className"]);return(0,t.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){i(e,r,n[r])}))}return e}({className:(0,o.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-400 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,n)},a))}}},function(e){e.O(0,[774,888,179],(function(){return r=9766,e(e.s=r);var r}));var r=e.O();_N_E=r}]);