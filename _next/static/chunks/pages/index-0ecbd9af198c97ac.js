(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3535:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(639)}])},639:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return k}});var n=t(4637),o=t(9496);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function u(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c,l,i=function(e){var r=e.className,t=u(e,["className"]);return(0,n.jsx)("select",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){a(e,r,t[r])}))}return e}({className:"block text-gray-700 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ".concat(r||"")},t))};function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(l=c||(c={})).googlesheetsurl="googlesheetsurl",l.csvurl="csvurl",l.googleDrive="googledrive";var f=function(e){return(0,n.jsx)(i,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){s(e,r,t[r])}))}return e}({},e,{children:(0,n.jsx)("option",{value:c.googlesheetsurl,children:"Google Sheets URL"})}))},b=t(1626);function g(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var y=function(e){var r=e.error,t=e.className,o=p(e,["error","className"]);return(0,n.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){g(e,r,t[r])}))}return e}({className:(0,b.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,t)},o))};function d(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function m(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var h="bg-gray-600 hover:bg-gray-700",v=function(e){var r=e.bg,t=void 0===r?h:r,o=e.type,a=void 0===o?"button":o,u=e.className,c=m(e,["bg","type","className"]),l=(0,b.Z)(u,t,"py-2 px-4 flex justify-center items-center focus:ring-gray-500 focus:ring-offset-gray-200 text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg");return(0,n.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){d(e,r,t[r])}))}return e}({type:a,className:l},c))},O=function(e){var r=e.datasource,t=e.isRenderingUrlErrorState,a=e.isSubmitDisabled,u=e.onDatasourceSourceChange,l=e.onSubmit,i=e.onUrlChange,s=e.url,b=(0,o.useState)(!1),g=b[0];b[1];(0,o.useEffect)((function(){g&&l()}),[g,l]);var p=r===c.googleDrive;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"gray-200 text-gray-600 text-center",children:"Enter your datasource"}),(0,n.jsx)(f,{className:"w-full mt-1",value:r,onChange:u}),p?null:(0,n.jsx)(y,{error:t,className:"w-full mt-1 w-full",placeholder:"https://url/to/data",defaultValue:s,onChange:function(e){return i(e.currentTarget.value)}}),t?(0,n.jsxs)("p",{className:"text-red-600 text-left text-sm",children:["Sheets URL must have the form:",(0,n.jsx)("br",{}),"https://docs.google.com/spreadsheets/d/:id/gviz/tq"]}):null,p?null:(0,n.jsx)(v,{disabled:a,className:"block m-auto mt-2",bg:a?"bg-gray-300":void 0,onClick:l,children:"Submit"})]})};function j(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var u,c=e[Symbol.iterator]();!(n=(u=c.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(l){o=!0,a=l}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function w(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(e){try{var r=new URL(e),t=j(r.pathname.substr(1).split("/"),3),n=t[0],o=t[1],a=t[2];if("spreadsheets"===n&&"d"===o&&a&&r.host.match("google.com"))return!0}catch(u){}return!1}function S(e){if(!x(e))throw new Error("url incompatible ".concat(e));var r=new URL(e);return r.pathname=w(r.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(r)}var P=t(7309),N=t(9275),E=t(4232);function k(){var e=(0,P.wl)(),r=e.value,t=r.url,o=r.datasource,a=e.update,u=(0,E.jU)(),c=u.value.accessToken,l=(u.update,x(t)),i=(0,N.useRouter)(),s=!(!t||l),f=!l||!c;return(0,n.jsxs)("form",{className:"content home w-96 max-w-screen-md",onSubmit:function(e){return e.preventDefault()},children:[(0,n.jsx)("h1",{className:"text-4xl text-center",children:"airmap!"}),(0,n.jsx)(O,{isSubmitDisabled:f,datasource:o,onDatasourceSourceChange:function(e){a({url:t,datasource:e.currentTarget.value})},isRenderingUrlErrorState:s,onUrlChange:function(e){a({url:e,datasource:o})},url:t,onSubmit:function(){f||(a({datasource:o,url:S(t)}),i.push("/map"))}})]})}}},function(e){e.O(0,[888,179],(function(){return r=3535,e(e.s=r);var r}));var r=e.O();_N_E=r}]);