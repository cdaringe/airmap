(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[287],{9762:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/device/miniwras/calibration",function(){return n(7537)}])},7537:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return h}});var t=n(1250),a=n(9583),i=n(4185),l=n(9901),s=n(8556),c=n(6822),o=n(7410),u=n(5363);function d(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=[],t=!0,a=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(t=(l=s.next()).done)&&(n.push(l.value),!r||n.length!==r);t=!0);}catch(c){a=!0,i=c}finally{try{t||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){return function(e){if(Array.isArray(e)){for(var r=0,n=new Array(e.length);r<e.length;r++)n[r]=e[r];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e,r){return s.Sm.apply(void 0,m(e.sub500nm.map((function(e){return(0,s.VY)(e.value,e.diameterMidpointNm,e.calibrationIndex,r)}))))}var h=function(){var e,r=(0,i.useRouter)(),n=(0,u.wl)(),h=n.value.luggage;if(!h)return console.warn("missing miniwras luggage data, sending user to homepage"),r.replace("/"),null;var x=d(l.useState(0),2),v=x[0],j=x[1],b=h.features,N=(0,l.useState)((null===(e=b[v])||void 0===e?void 0:e.properties.pm05Naive)||0),g=N[0],y=N[1],_=l.useMemo((function(){return b.map((function(e,r){var n=s.Sm.apply(void 0,m(e.properties.channels.sub3000nm.map((function(e){return(0,s.Bk)(e.value,e.diameterMidpointNm,e.calibrationIndex)}))));return e.properties.pm_2_5/n}))}),[b]),M=l.useMemo((function(){return f(_)}),[_]),w=l.useMemo((function(){return function(e){var r=e.length,n=f(e);return Math.sqrt(e.map((function(e){return Math.pow(e-n,2)})).reduce((function(e,r){return e+r}))/r)}(_)}),[_]),E=l.useMemo((function(){var e=b[v].properties,r=s.Sm.apply(void 0,m(e.channels.sub500nm.map((function(e){return(0,s.Bk)(e.value,e.diameterMidpointNm,e.calibrationIndex)}))));return g/r}),[g,b,v]);return b.forEach((function(e){var r,n,t=e.properties;t.pm01To03Derived=(r=t.channels,n=M,s.Sm.apply(void 0,m(r.all.filter((function(e){return e.diameterMidpointNm>=100&&e.diameterMidpointNm<=300})).map((function(e){return(0,s.VY)(e.value,e.diameterMidpointNm,e.calibrationIndex,n)}))))),t.pm05Calibrated=p(t.channels,E),t.pm05To3Calibrated=t.pm_2_5-t.pm05Calibrated,t.pm05Derived=p(t.channels,M)})),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mt-4 mr-2",htmlFor:"reference",children:"Calibration Sample:"}),(0,t.jsx)("select",{onChange:function(e){j(parseInt(e.currentTarget.value,10))},children:b.map((function(e,r){return(0,t.jsx)("option",{value:r,children:r},r)}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mr-2",htmlFor:"reference",children:"0.5 \xb5g/m\xb3 reference:"}),(0,t.jsx)(o.Z,{name:"reference",label:"0.5 microgram per cubic meter reference",type:"number",onChange:function(e){try{y(parseFloat(e.currentTarget.value))}catch(r){}},defaultValue:g})]}),(0,t.jsxs)("table",{className:"mt-2",children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-1",children:"RHO_DERIVED (PM2.5) MEAN"}),(0,t.jsx)("th",{className:"p-1",children:"RHO_DERIVED (PM2.5) STD_DEV"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"p-1",children:M.toFixed(2)}),(0,t.jsx)("td",{className:"p-1",children:w.toFixed(2)})]})]}),(0,t.jsxs)("table",{className:"mt-2",children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-1",children:"RHO_GRIMM (PM0.5, kg/m3, Grimm)"}),(0,t.jsx)("th",{className:"p-1",children:"RHO_PM05_CALIBRATED (PM0.5, kg/m3)"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"p-1",children:s.w_.toFixed(2)}),(0,t.jsx)("td",{className:"p-1",children:E.toFixed(2)})]}),(0,t.jsx)("tr",{})]}),(0,t.jsx)("br",{}),(0,t.jsx)("div",{children:(0,t.jsx)(c.Z,{onClick:function(){n.update(n.value),r.push("/map")},children:"Continue"})}),(0,t.jsx)("br",{}),(0,t.jsx)(a.default,{children:(0,t.jsx)("style",{children:"\ntable#caltab, th, td {\n  border: 1px solid black;\n}\n"})},"caltable"),(0,t.jsxs)("table",{className:"mt-2",id:"caltab",children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-1",children:"Time"}),(0,t.jsx)("th",{className:"p-1",children:"RHO_DERIVED (PM2.5) \xb5g/m3"}),(0,t.jsx)("th",{className:"p-1",children:"Density \xb5g/m3 PM0.5 (naive)"}),(0,t.jsx)("th",{className:"p-1",children:"Density \xb5g/m3 PM0.5 (calibrated)"})]}),h.features.map((function(e,r){var n=e.properties,a=n.date,i=n.pm05Naive,l=n.pm05Calibrated;return(0,t.jsxs)("tr",{className:r===v?"bg-lime-200":"",children:[(0,t.jsx)("td",{className:"p-1",children:a.toLocaleTimeString()}),(0,t.jsx)("td",{className:"p-1",children:_[r].toFixed()}),(0,t.jsx)("td",{className:"p-1",children:i.toFixed(2)}),(0,t.jsx)("td",{className:"p-1",children:l.toFixed(2)})]},r)}))]})]})},f=function(e){return s.Sm.apply(void 0,m(e))/e.length}}},function(e){e.O(0,[238,774,888,179],(function(){return r=9762,e(e.s=r);var r}));var r=e.O();_N_E=r}]);