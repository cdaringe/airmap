(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[650],{9677:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/charts",function(){return r(5713)}])},5713:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return N}});var n=r(1250),o=r(9901),a=r(4708),u=r(5619),c=r(8028),i=r(1167),s=r(7481),l=r(1180),f=r(4235),d=r.n(f),p=r(8317),h=r(7282),y=function(e){return[e.getDate(),e.getMonth(),e.getFullYear()]};function v(e){if(Array.isArray(e))return e}function b(e,t,r,n,o,a,u){try{var c=e[a](u),i=c.value}catch(s){return void r(s)}c.done?t(i):Promise.resolve(i).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function u(e){b(a,n,o,u,c,"next",e)}function c(e){b(a,n,o,u,c,"throw",e)}u(void 0)}))}}function w(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function x(e,t){return v(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var u,c=e[Symbol.iterator]();!(n=(u=c.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(i){o=!0,a=i}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}(e,t)||m()}function j(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return!t||"object"!==C(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var u,c=e[Symbol.iterator]();!(n=(u=c.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(i){o=!0,a=i}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var C=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}var A=[new Date("2021-08-17 00:00:00"),new Date("2021-09-23 00:00:00")],F=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(u,e);var t,r,o,a=T(u);function u(){return k(this,u),a.apply(this,arguments)}return t=u,(r=[{key:"render",value:function(){var e=this.props,t=e.x,r=e.y,o=(e.stroke,e.payload);return(0,n.jsx)("g",{transform:"translate(".concat(t,",").concat(r,")"),children:(0,n.jsx)("text",{x:0,y:0,dy:16,textAnchor:"end",fill:"#666",transform:"rotate(-35)",children:o.value})})}}])&&_(t.prototype,r),o&&_(t,o),u}(o.PureComponent),P=function(){return window.document.body.getBoundingClientRect().width},R=function(e){var t=e.onChange,r=e.value,o=D(y(r),3),a=o[0],u=o[1],c=[o[2],u,a].map((function(e,t){var r=String(e);return 0===t?r:1===r.length?"0".concat(r):r})).join("-");return(0,n.jsx)("input",{type:"date",pattern:"\\d{4}-\\d{2}-\\d{2}",className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date",onChange:t,value:c})};var N=function(){var e=(0,o.useState)(A[0]),t=e[0],r=e[1],f=(0,o.useState)(A[1]),b=f[0],k=f[1],_=(0,o.useState)(P()),O=_[0],E=_[1];(0,o.useLayoutEffect)((function(){var e=function(){E(P())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var S=function(e,t,r,n){var o=x(t,2),a=o[0],u=o[1];return(0,h.useQuery)({queryKey:"get-chart-".concat(e,"-").concat(a.getTime(),"-").concat(u.getTime()),queryFn:g(d().mark((function e(t){var n,o,c,i,s,l,f,h,b,k,_;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,o=[],e.next=4,fetch(r);case 4:if(c=e.sent,i=c.body){e.next=8;break}throw new Error("missing data");case 8:return s=i.getReader(),l=new TextDecoder,f=l.decode.bind(l),h=function(e){return parseInt(e,10)},b=[function(e){return new Date(e)},parseFloat,h,h,h,parseFloat,parseFloat,parseFloat],k=new ReadableStream({start:function(e){return g(d().mark((function t(){var r,c,i,l,h,y,v,g,w,m,x,j,k;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,s.read();case 3:if(r=t.sent,c=r.done,i=r.value,!c){t.next=8;break}return t.abrupt("break",31);case 8:if(l=f(i),!(h=(0,p.parse)(l)).errors.length){t.next=12;break}throw new Error(JSON.stringify(h.errors));case 12:for(y=!0,v=!1,g=void 0,t.prev=13,w=h.data[Symbol.iterator]();!(y=(m=w.next()).done);y=!0)x=m.value,n?(j=x.map((function(e,t){return b[t](e)})),(k=j[0])>=a&&k<=u&&o.push(j)):n=x;t.next=21;break;case 17:t.prev=17,t.t0=t.catch(13),v=!0,g=t.t0;case 21:t.prev=21,t.prev=22,y||null==w.return||w.return();case 24:if(t.prev=24,!v){t.next=27;break}throw g;case 27:return t.finish(24);case 28:return t.finish(21);case 29:t.next=0;break;case 31:e.close(),s.releaseLock();case 33:case"end":return t.stop()}}),t,null,[[13,17,21,29],[22,,24,28]])})))()}}),e.next=17,new Response(k).blob();case 17:return _=j(o.reduce((function(e,t){var r=x(t,1)[0],n=x(y(r),3),o=n[0],a=n[1],u=n[2],c="".concat(o,"_").concat(a,"_").concat(u),i=e.get(c)||[];return i.push(t),e.set(c,i),e}),new Map).values()).map((function(e){var t,r=v(t=x(e,1)[0])||w(t)||m(),n=r[0],o=(r[1],r.slice(2),parseFloat((e.reduce((function(e,t){return e+x(t,2)[1]}),0)/e.length).toFixed(2))),a=new Date(n.getFullYear(),n.getMonth(),n.getDate());return{date:a,prettyDate:"".concat(a.getDate()," ").concat(a.toLocaleString("default",{month:"long"})," ").concat(a.getFullYear()),vocAverage:o}})).sort((function(e,t){return e.date>t.date?1:-1})),e.abrupt("return",{header:n,rows:_});case 19:case"end":return e.stop()}}),e)})))})}("sampleatmos",[t,b],["/airmap","/atmotube__bank_st__sample.csv"].join("")),D=S.isLoading,C=S.error,T=S.data;if(D)return"is loading";if(C)return String(C);var N=null===T||void 0===T?void 0:T.rows;if(!N)throw new Error("missing data");return(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"start-date",children:"Start Date"}),(0,n.jsx)(R,{name:"start-date",value:t,onChange:function(e){var t=new Date(e.currentTarget.value);t>b||r(t)}}),(0,n.jsx)("label",{htmlFor:"end-date",children:"End Date"}),(0,n.jsx)(R,{name:"end-date",value:b,onChange:function(e){var r=new Date(e.currentTarget.value);r<t||k(r)}}),(0,n.jsx)("h1",{className:"block text-xl text-center",children:"VOC, ppm"}),(0,n.jsx)("br",{}),(0,n.jsxs)(a.T,{width:O,height:600,data:N,margin:{top:10,right:30,left:0,bottom:0},children:[(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:"colorVoc",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})]})}),(0,n.jsx)(u.u,{fillOpacity:1,fill:"url(#colorVoc)",type:"monotone",dataKey:"vocAverage",stroke:"#8884d8"}),(0,n.jsx)(c.q,{vertical:!0,horizontal:!0,stroke:"#ccc",strokeDasharray:"3 3"}),(0,n.jsx)(i.u,{}),(0,n.jsx)(s.K,{label:"Date",height:200,dataKey:"prettyDate",tick:(0,n.jsx)(F,{})}),(0,n.jsx)(l.B,{label:"VOC, ppm"})]})]})}}},function(e){e.O(0,[56,106,774,888,179],(function(){return t=9677,e(e.s=t);var t}));var t=e.O();_N_E=t}]);