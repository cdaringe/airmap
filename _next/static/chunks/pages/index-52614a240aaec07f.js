(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8530:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(8550)}])},8550:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return C}});var n=t(1250);t(9901);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u,l,s=function(e){var r=e.className,t=a(e,["className"]);return(0,n.jsx)("select",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){o(e,r,t[r])}))}return e}({className:"block text-gray-700 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ".concat(r||"")},t))};function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(l=u||(u={})).googlesheetsurl="googlesheetsurl",l.csvurl="csvurl",l.googleDrive="googledrive";var i=function(e){return(0,n.jsxs)(s,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){c(e,r,t[r])}))}return e}({},e,{children:[(0,n.jsx)("option",{value:u.googlesheetsurl,children:"Google Sheets URL"}),(0,n.jsx)("option",{disabled:!0,value:u.googleDrive,children:"Google Drive"}),(0,n.jsx)("option",{disabled:!0,value:u.csvurl,children:"CSV URL"})]}))},f=t(5789);function p(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function b(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var g=function(e){var r=e.error,t=e.className,o=b(e,["error","className"]);return(0,n.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){p(e,r,t[r])}))}return e}({className:(0,f.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,t)},o))};function d(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function y(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var m="bg-gray-600 hover:bg-gray-700",h=function(e){var r=e.bg,t=void 0===r?m:r,o=e.type,a=void 0===o?"button":o,u=e.className,l=y(e,["bg","type","className"]),s=(0,f.Z)(u,t,"py-2 px-4 flex justify-center items-center focus:ring-gray-500 focus:ring-offset-gray-200 text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg");return(0,n.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){d(e,r,t[r])}))}return e}({type:a,className:s},l))},v=t(4313),O=function(e){var r=e.datasource,t=e.isRenderingUrlErrorState,o=e.isSubmitDisabled,a=e.onDatasourceSourceChange,u=e.onSubmit,l=e.onUrlsChange,c=e.onSensorTypeChange,f=e.sensorType,p=e.urls;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"gray-200 text-gray-600 text-center",children:"Enter your datasource"}),(0,n.jsxs)(s,{defaultValue:f,placeholder:"Select sensor type",className:"w-full mt-1",onMouseOver:function(){f===v.$C&&c(-1)},onMouseOut:function(){f<v.$C&&c(0)},onChange:function(e){var r=e.currentTarget.value;l([]),c(parseInt(r,10))},children:[(0,n.jsx)("option",{disabled:!0,value:v.$C,children:"Select sensor type..."}),(0,n.jsx)("option",{value:v.OS,children:"Flow"}),(0,n.jsx)("option",{value:v.p4,children:"PocketLabs"})]}),(0,n.jsx)(i,{required:!0,className:"w-full mt-1",value:r,onChange:a}),(0,n.jsx)(g,{required:!0,error:t,className:"w-full mt-1 w-full",placeholder:f===v.OS?"User Measures: https://url/to/data":"https://url/to/data",defaultValue:p[0],onChange:function(e){return l([e.currentTarget.value,p[1]].filter(Boolean))}},"".concat(f,"-url-1")),f===v.OS?(0,n.jsx)(g,{required:!0,error:t,className:"w-full mt-1 w-full",placeholder:"User Positions: https://url/to/data",defaultValue:p[1],onChange:function(e){return l([p[0],e.currentTarget.value])}},"".concat(f,"-url-2")):null,t?(0,n.jsxs)("p",{className:"text-red-600 text-left text-sm",children:["Sheets URL must have the form:",(0,n.jsx)("br",{}),"https://docs.google.com/spreadsheets/d/:id/gviz/tq"]}):null,(0,n.jsx)(h,{disabled:o,className:"block m-auto mt-2",bg:o?"bg-gray-300":void 0,onClick:u,children:"Submit"})]})};function j(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var u,l=e[Symbol.iterator]();!(n=(u=l.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(s){o=!0,a=s}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function w(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(e){try{var r=new URL(e),t=j(r.pathname.substr(1).split("/"),3),n=t[0],o=t[1],a=t[2];if("spreadsheets"===n&&"d"===o&&a&&r.host.match("google.com"))return!0}catch(u){}return!1}var S=t(4566),P=t(2737),N=t(9374);function C(){var e=(0,S.wl)(),r=e.value,t=r.urls,o=r.datasource,a=r.sensorType,u=e.update,l=(0,N.jU)(),s=l.value.accessToken,c=(l.update,t.every((function(e){return x(e)}))&&(a!==v.OS||2===t.length)),i=(0,P.useRouter)(),f=!(!t.length||c),p=!c||!s||a===v.$C;return(0,n.jsxs)("form",{className:"content home w-96 max-w-screen-md",onSubmit:function(e){return e.preventDefault()},children:[(0,n.jsx)("h1",{className:"text-4xl text-center",children:"airmap!"}),(0,n.jsx)(O,{isSubmitDisabled:p,datasource:o,sensorType:a,onDatasourceSourceChange:function(e){u({urls:t,sensorType:a,datasource:e.currentTarget.value})},isRenderingUrlErrorState:f,onSensorTypeChange:function(e){u({urls:t,sensorType:e,datasource:o})},onUrlsChange:function(e){u({urls:e,sensorType:a,datasource:o})},urls:t,onSubmit:function(){p||(u({datasource:o,sensorType:a,urls:t.map((function(e){return function(e){if(!x(e))throw new Error("url incompatible ".concat(e));var r=new URL(e);return r.pathname=w(r.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(r)}(e)}))}),i.push("/map"))}})]})}}},function(e){e.O(0,[774,888,179],(function(){return r=8530,e(e.s=r);var r}));var r=e.O();_N_E=r}]);