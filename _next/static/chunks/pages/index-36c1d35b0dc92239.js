(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{2268:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(9213)}])},1988:function(e,r,t){"use strict";t.d(r,{Ok:function(){return a},Hw:function(){return i},e5:function(){return l}});var n=t(5624);function o(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(i){o=!0,u=i}finally{try{n||null==l.return||l.return()}finally{if(o)throw u}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e){try{var r=new URL(e),t=o(r.pathname.substr(1).split("/"),3),n=t[0],u=t[1],a=t[2];if("spreadsheets"===n&&"d"===u&&a&&r.host.match("google.com"))return!0}catch(l){}return!1}function l(e){var r=new URL(e);return r.pathname=u(r.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(r)}var i=function(e){var r=new URL(e),t=new URLSearchParams(r.search);return t.has("format")||t.set("format","csv"),r.search=t.toString(),function(e,r){return fetch(e,r).then((function(e){return e.body})).then((function(e){var r=null===e||void 0===e?void 0:e.getReader();return(0,n.k)(r,"missing stream body"),r}))}(l(r.toString()),{mode:"cors",redirect:"follow",headers:{accept:"text"}})}},5624:function(e,r,t){"use strict";function n(e,r){if(null===e||void 0===e)throw Error(r)}t.d(r,{k:function(){return n}})},9213:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return k}});var n=t(1250),o=t(4235),u=t.n(o);t(9901);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function l(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i,c,s=function(e){var r=e.className,t=l(e,["className"]);return(0,n.jsx)("select",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){a(e,r,t[r])}))}return e}({className:"block text-gray-700 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ".concat(r||"")},t))};function f(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(c=i||(i={})).googlesheetsurl="googlesheetsurl",c.csvurl="csvurl",c.googleDrive="googledrive";var p=function(e){return(0,n.jsxs)(s,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){f(e,r,t[r])}))}return e}({},e,{children:[(0,n.jsx)("option",{value:i.googlesheetsurl,children:"Google Sheets URL"}),(0,n.jsx)("option",{disabled:!0,value:i.googleDrive,children:"Google Drive"}),(0,n.jsx)("option",{disabled:!0,value:i.csvurl,children:"CSV URL"})]}))},d=t(7210),g=t(9944),b=t(797);function y(e,r,t,n,o,u,a){try{var l=e[u](a),i=l.value}catch(c){return void t(c)}l.done?r(i):Promise.resolve(i).then(n,o)}function h(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(i){o=!0,u=i}finally{try{n||null==l.return||l.return()}finally{if(o)throw u}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var m=function(e){var r,t=e.datasource,o=e.isRenderingUrlErrorState,a=e.isSubmitDisabled,l=e.luggage,i=e.onDatasourceSourceChange,c=e.onKmlChange,f=e.onSubmit,m=e.onUrlsChange,v=e.onSensorTypeChange,O=e.sensorType,j=e.urls;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-center text-gray-600 gray-200",children:"Enter your datasource"}),(0,n.jsxs)(s,{defaultValue:O,placeholder:"Select sensor type",className:"w-full mt-1",onMouseOver:function(){O===b.$C&&v(-1)},onMouseOut:function(){O<b.$C&&v(0)},onChange:function(e){var r=e.currentTarget.value;m([]),v(parseInt(r,10))},children:[(0,n.jsx)("option",{disabled:!0,value:b.$C,children:"Select sensor type..."}),(0,n.jsx)("option",{value:b.OS,children:"Flow"}),(0,n.jsx)("option",{value:b.p4,children:"PocketLabs"}),(0,n.jsx)("option",{value:b.R3,children:"MiniWRAS"}),(0,n.jsx)("option",{value:b.xV,children:"airmap\u2122 GPS"})]}),(0,n.jsx)(p,{required:!0,className:"w-full mt-1",value:t,onChange:i}),(0,n.jsx)(d.Z,{required:!0,error:o,className:"w-full mt-1",placeholder:O===b.OS?"User Measures: https://url/to/data":"https://url/to/data",defaultValue:j[0],onChange:function(e){return m([e.currentTarget.value,j[1]].filter(Boolean))}},"".concat(O,"-url-1")),O===b.OS||O===b.R3?(0,n.jsx)(d.Z,{required:!0,error:o,className:"w-full mt-1",placeholder:"User Positions: https://url/to/data",defaultValue:j[1],onChange:function(e){return m([j[0],e.currentTarget.value])}},"".concat(O,"-url-2")):null,o?(0,n.jsxs)("p",{className:"text-sm text-left text-red-600",children:["Sheets URL must have the form:",(0,n.jsx)("br",{}),"https://docs.google.com/spreadsheets/d/:id/gviz/tq"]}):null,O===b.R3?(0,n.jsxs)("div",{className:"mt-1",children:[(0,n.jsx)("label",{htmlFor:"kineticlitegps",className:"p-2 text-white bg-blue-600 rounded hover:cursor-pointer",children:"Upload KineticLite GPS"}),(0,n.jsx)("input",{type:"file",onChange:(r=u().mark((function e(r){var t,n,o,a,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(t=r.target)||void 0===t?void 0:t.files){e.next=4;break}throw new Error("null files");case 4:return o=h(n,1),a=o[0],e.next=7,a.text();case 7:l=e.sent,c(l);case 9:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var u=r.apply(e,t);function a(e){y(u,n,o,a,l,"next",e)}function l(e){y(u,n,o,a,l,"throw",e)}a(void 0)}))}),"aria-label":"gps upload",className:"hidden",accept:".kml",id:"kineticlitegps",name:"kineticlitegps"}),l?"> Uploaded":null]}):null,(0,n.jsx)(g.Z,{disabled:a,className:"block m-auto mt-2",onClick:f,children:"Submit"})]})},v=t(1988),O=t(2168),j=t(4221),w=t(8247);function x(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){x(e,r,t[r])}))}return e}var P=[];function k(){var e=(0,O.wl)(),r=e.value,t=e.update,o=r.urls,u=r.datasource,a=r.sensorType,l=r.luggage,i=function(e,n){return t(S({},r,x({},e,n)))},c=(0,w.jU)(),s=c.value.accessToken,f=(c.update,o.every((function(e){return(0,v.Ok)(e)}))&&(a!==b.OS||2===o.length)),p=(0,j.useRouter)(),d=!(!o.length||f),g=!f||!s||0===a||a===b.R3&&!l;return(0,n.jsxs)("form",{className:"max-w-screen-md content home w-96",onSubmit:function(e){return e.preventDefault()},children:[(0,n.jsx)("h1",{className:"text-4xl text-center",children:"airmap!"}),(0,n.jsx)(m,{isSubmitDisabled:g,luggage:l,datasource:u,sensorType:a,isRenderingUrlErrorState:d,onDatasourceSourceChange:function(e){return i("datasource",e.currentTarget.value)},onSensorTypeChange:function(e){return t((function(t){return S({},t,{luggage:P.includes(r.sensorType)?t.luggage:null,urls:[],sensorType:e})}))},onUrlsChange:function(e){return i("urls",e)},onKmlChange:function(e){return i("luggage",e)},urls:o,onSubmit:function(){g||(i("urls",o.map((function(e){return(0,v.e5)(e)}))),p.push("/map"))}}),null]})}},9944:function(e,r,t){"use strict";var n=t(1250),o=t(5789);t(9901);function u(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l="bg-gray-600 hover:bg-gray-700 focus:ring-gray-500 focus:ring-offset-gray-200",i="flex";r.Z=function(e){var r=e.styles,t=void 0===r?{}:r,c=t.bg,s=void 0===c?l:c,f=t.display,p=void 0===f?i:f,d=e.type,g=void 0===d?"button":d,b=e.className,y=a(e,["styles","type","className"]),h=(0,o.Z)(b,s,p,"py-2 px-4 justify-center items-center text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg",y.disabled?"bg-gray-400 hover:bg-gray-400 cursor-not-allowed":"");return(0,n.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){u(e,r,t[r])}))}return e}({type:g,className:h},y))}},7210:function(e,r,t){"use strict";var n=t(1250),o=(t(9901),t(5789));function u(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}r.Z=function(e){var r=e.error,t=e.className,l=a(e,["error","className"]);return(0,n.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){u(e,r,t[r])}))}return e}({className:(0,o.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,t)},l))}}},function(e){e.O(0,[774,888,179],(function(){return r=2268,e(e.s=r);var r}));var r=e.O();_N_E=r}]);