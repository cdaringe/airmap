(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{2268:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(5808)}])},1988:function(e,r,t){"use strict";t.d(r,{Ok:function(){return a},Hw:function(){return s},e5:function(){return c}});var n=t(5624);function o(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(s){o=!0,u=s}finally{try{n||null==c.return||c.return()}finally{if(o)throw u}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e){try{var r=new URL(e),t=o(r.pathname.substr(1).split("/"),3),n=t[0],u=t[1],a=t[2];if("spreadsheets"===n&&"d"===u&&a&&r.host.match("google.com"))return!0}catch(c){}return!1}function c(e){var r=new URL(e);return r.pathname=u(r.pathname.substr(1).split("/").splice(0,3)).concat(["export"]).join("/"),String(r)}var s=function(e){var r=new URL(e),t=new URLSearchParams(r.search);return t.has("format")||t.set("format","csv"),r.search=t.toString(),function(e,r){return fetch(e,r).then((function(e){return e.body})).then((function(e){var r=null===e||void 0===e?void 0:e.getReader();return(0,n.k)(r,"missing stream body"),r}))}(c(r.toString()),{mode:"cors",redirect:"follow",headers:{accept:"text"}})}},5624:function(e,r,t){"use strict";function n(e,r){if(null===e||void 0===e)throw Error(r)}t.d(r,{k:function(){return n}})},5808:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return P}});var n=t(1250);t(9901);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function u(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var a,c,s=function(e){var r=e.className,t=u(e,["className"]);return(0,n.jsx)("select",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){o(e,r,t[r])}))}return e}({className:"block text-gray-700 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ".concat(r||"")},t))};function l(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(c=a||(a={})).googlesheetsurl="googlesheetsurl",c.csvurl="csvurl",c.googleDrive="googledrive";var i=function(e){return(0,n.jsxs)(s,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){l(e,r,t[r])}))}return e}({},e,{children:[(0,n.jsx)("option",{value:a.googlesheetsurl,children:"Google Sheets URL"}),(0,n.jsx)("option",{disabled:!0,value:a.googleDrive,children:"Google Drive"}),(0,n.jsx)("option",{disabled:!0,value:a.csvurl,children:"CSV URL"})]}))},f=t(5789);function p(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function b(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var d=function(e){var r=e.error,t=e.className,o=b(e,["error","className"]);return(0,n.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){p(e,r,t[r])}))}return e}({className:(0,f.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-300 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,t)},o))};function g(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function y(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var h="bg-gray-600 hover:bg-gray-700",m=function(e){var r=e.bg,t=void 0===r?h:r,o=e.type,u=void 0===o?"button":o,a=e.className,c=y(e,["bg","type","className"]),s=(0,f.Z)(a,t,"py-2 px-4 flex justify-center items-center focus:ring-gray-500 focus:ring-offset-gray-200 text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg");return(0,n.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){g(e,r,t[r])}))}return e}({type:u,className:s},c))},v=t(797),O=function(e){var r=e.datasource,t=e.isRenderingUrlErrorState,o=e.isSubmitDisabled,u=e.onDatasourceSourceChange,a=e.onSubmit,c=e.onUrlsChange,l=e.onSensorTypeChange,f=e.sensorType,p=e.urls;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-center text-gray-600 gray-200",children:"Enter your datasource"}),(0,n.jsxs)(s,{defaultValue:f,placeholder:"Select sensor type",className:"w-full mt-1",onMouseOver:function(){f===v.$C&&l(-1)},onMouseOut:function(){f<v.$C&&l(0)},onChange:function(e){var r=e.currentTarget.value;c([]),l(parseInt(r,10))},children:[(0,n.jsx)("option",{disabled:!0,value:v.$C,children:"Select sensor type..."}),(0,n.jsx)("option",{value:v.OS,children:"Flow"}),(0,n.jsx)("option",{value:v.p4,children:"PocketLabs"})]}),(0,n.jsx)(i,{required:!0,className:"w-full mt-1",value:r,onChange:u}),(0,n.jsx)(d,{required:!0,error:t,className:"w-full mt-1 w-full",placeholder:f===v.OS?"User Measures: https://url/to/data":"https://url/to/data",defaultValue:p[0],onChange:function(e){return c([e.currentTarget.value,p[1]].filter(Boolean))}},"".concat(f,"-url-1")),f===v.OS?(0,n.jsx)(d,{required:!0,error:t,className:"w-full mt-1 w-full",placeholder:"User Positions: https://url/to/data",defaultValue:p[1],onChange:function(e){return c([p[0],e.currentTarget.value])}},"".concat(f,"-url-2")):null,t?(0,n.jsxs)("p",{className:"text-sm text-left text-red-600",children:["Sheets URL must have the form:",(0,n.jsx)("br",{}),"https://docs.google.com/spreadsheets/d/:id/gviz/tq"]}):null,(0,n.jsx)(m,{disabled:o,className:"block m-auto mt-2",bg:o?"bg-gray-300":void 0,onClick:a,children:"Submit"})]})},j=t(1988),w=t(2168),x=t(4221),S=t(8247);function P(){var e=(0,w.wl)(),r=e.value,t=r.urls,o=r.datasource,u=r.sensorType,a=e.update,c=(0,S.jU)(),s=c.value.accessToken,l=(c.update,t.every((function(e){return(0,j.Ok)(e)}))&&(1!==u||2===t.length)),i=(0,x.useRouter)(),f=!(!t.length||l),p=!l||!s||0===u;return(0,n.jsxs)("form",{className:"max-w-screen-md content home w-96",onSubmit:function(e){return e.preventDefault()},children:[(0,n.jsx)("h1",{className:"text-4xl text-center",children:"airmap!"}),(0,n.jsx)(O,{isSubmitDisabled:p,datasource:o,sensorType:u,onDatasourceSourceChange:function(e){a({urls:t,sensorType:u,datasource:e.currentTarget.value})},isRenderingUrlErrorState:f,onSensorTypeChange:function(e){a({urls:t,sensorType:e,datasource:o})},onUrlsChange:function(e){a({urls:e,sensorType:u,datasource:o})},urls:t,onSubmit:function(){p||(a({datasource:o,sensorType:u,urls:t.map((function(e){return(0,j.e5)(e)}))}),i.push("/map"))}})]})}}},function(e){e.O(0,[774,888,179],(function(){return r=2268,e(e.s=r);var r}));var r=e.O();_N_E=r}]);