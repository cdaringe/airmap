"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[296],{1804:function(e,r,n){var t=n(1250),o=n(5789);n(9901);function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u="bg-gray-600 hover:bg-gray-700 focus:ring-gray-500 focus:ring-offset-gray-200",c="flex";r.Z=function(e){var r=e.styles,n=void 0===r?{}:r,l=n.bg,s=void 0===l?u:l,f=n.display,p=void 0===f?c:f,d=e.type,m=void 0===d?"button":d,y=e.className,b=a(e,["styles","type","className"]),g=(0,o.Z)(y,s,p,"py-2 px-4 justify-center items-center text-white transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg",b.disabled?"bg-gray-400 hover:bg-gray-400 cursor-not-allowed":"");return(0,t.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){i(e,r,n[r])}))}return e}({type:m,className:g},b))}},1750:function(e,r,n){var t=n(1250),o=(n(9901),n(5789));function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}r.Z=function(e){var r=e.error,n=e.className,u=a(e,["error","className"]);return(0,t.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){i(e,r,n[r])}))}return e}({className:(0,o.Z)("rounded-lg border-transparent flex-1 appearance-none border border-gray-400 py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",r?"border-red-600":void 0,n)},u))}},637:function(e,r,n){function t(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(r){t(e,r,n[r])}))}return e}n.d(r,{w_:function(){return a.RHO_GRIMM},$e:function(){return i},Sm:function(){return a.sum},VY:function(){return a["toPartial\u03bcgPerM3"]},Bk:function(){return a["toPartial\u03bcgPerM3SansRho"]}});var i=function(e){var r=e.pocketlabs,n=void 0===r?[]:r,t=e.strava,i=e.miniwras,a=function(e){for(;;){var r=t[0],n=null===r||void 0===r?void 0:r.date;if(!n||!r)return console.warn("no strava data, skipping, dropping miniwras point"),null;if(!(n<e))return n.getTime()-e.getTime()<6e4?(t.shift(),r):(console.warn("miniwras > 1 minute away from strava points, dropping miniwras point"),null);t.shift()}},u=function(e){for(;;){var r=n[0],t=null===r||void 0===r?void 0:r.date;if(!t||!r)return null;if(!(t<e))return t.getTime()-e.getTime()<6e4?(n.shift(),r):null;n.shift()}},c=[],l=!0,s=!1,f=void 0;try{for(var p,d=i[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value,y=m.date,b=a(y),g=u(y);b&&c.push(o({latitude:b.lat,longitude:b.lon},b,m,{pm05Calibrated:-1,pm05Derived:-1,pm05To3Calibrated:-1,pocketlabsEntry:g||void 0}))}}catch(v){s=!0,f=v}finally{try{l||null==d.return||d.return()}finally{if(s)throw f}}return{type:"FeatureCollection",features:c.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:e}}))}},a=n(1321)},1321:function(e,r,n){n.r(r),n.d(r,{RHO_GRIMM:function(){return l},parse:function(){return v},sum:function(){return f},"toPartial\u03bcgPerM3":function(){return m},"toPartial\u03bcgPerM3SansRho":function(){return y}});var t=n(4235),o=n.n(t),i=n(6930);function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=[],t=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done)&&(n.push(a.value),!r||n.length!==r);t=!0);}catch(c){o=!0,i=c}finally{try{t||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,r,n,t,o,i,a){try{var u=e[i](a),c=u.value}catch(l){return void n(l)}u.done?r(c):Promise.resolve(c).then(t,o)}var c,l=1800,s=[6.842765,7.1751666,7.0114602,6.9088991,7.0263146,6.9180838,7.0393966,6.989318,6.9812267,5.2701795,14.0655402,13.8262107,14.1929174,14.0017841,13.8883794,13.9963284,14.0409634,14.2779903,13.8513492,13.898864,13.6873067,14.3390373,13.8184393,14.1478588,14.0655395,13.8262102,14.1929179,13.8296286,14.062005,13.9963317,14.040958,14.001345,13.96783,14,13.95533,14.00924,14,14,14,14,14],f=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.reduce((function(e,r){return e+r}),0)},p=function(e){return e/1e9},d=function(e){return 1e6*e},m=function(e,r,n,t){return d(e)/s[n]*(Math.PI/6)*Math.pow(p(r),3)*t*1e9},y=function(e,r,n){return d(e)/s[n]*(Math.PI/6)*Math.pow(p(r),3)*1e9},b=function(e){return new Date(e.trim().split(" ").map((function(e,r){if(0===r){var n=a(e.split("/"),3),t=n[0],o=n[1],i=n[2],u=function(e){return 1===e.length?"0".concat(e):e};return"".concat(t,"-").concat(u(o),"-").concat(u(i))}return"T".concat(e,".000+01:00")})).join(""))},g=function(e){return parseFloat(e)},v=(c=o().mark((function e(r,n){var t,a,u,c,s,f,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===n?{records:[],partial:"",particleDiametersAscending:[]}:n,e.next=3,r.read();case 3:return a=e.sent,u=a.done,((c=a.value)||u)&&(t.partial+="string"===typeof c?c:c?(new TextDecoder).decode(c):"",s=t.partial.split(/\n/g),f=s.map((function(e){return e.trim()})).filter((function(e){return!!e})),p=f.length-1,f.forEach((function(e,r){if(p!==r||u){var n=e.includes(",")?e.split(","):e.split("\t");if(t.headerIndiciesByName){var o=n[t.headerIndiciesByName.Time],a=n[t.headerIndiciesByName["pm2.5 [ug/m3]"]];(0,i.k)(o,"date missing"),(0,i.k)(Number.isFinite(a),"column 'pm2.5 [ug/m3]' missing");for(var c=0,s=t.headerIndiciesByName["10.00 nm"],f=t.headerIndiciesByName["449.48 nm"],d=t.headerIndiciesByName["3238.77 nm"],y=[],v=0,h={sub500nm:[],sub3000nm:[]};s<d;){var w=parseFloat(n[s]),O=(t.particleDiametersAscending[v]+t.particleDiametersAscending[v+1])/2,P={value:w,diameterMidpointNm:O,calibrationIndex:v},j=m(w,O,v,l);s<f&&(h.sub500nm.push(P),c+=j),s<d&&h.sub3000nm.push(P),++s,++v}console.log({sampleNum:t.records.length,pm05:c,debug:y}),t.records.push({channels:h,date:b(o),debug:y,pm05EndCol:f,pm05Naive:c,pm_2_5:g(a)}),u&&(t.partial="")}else t.headerCells=n,t.headerIndiciesByName=n.reduce((function(e,r,n){var o=r.trim();e[o]=n;var i=o.match(/\s*(\d+\.\d+)\s+nm/);return i&&t.particleDiametersAscending.push(parseInt(i[1],10)),e}),{})}else t.partial=e}))),e.abrupt("return",u?t:v(r,t));case 8:case"end":return e.stop()}}),e)})),function(){var e=this,r=arguments;return new Promise((function(n,t){var o=c.apply(e,r);function i(e){u(o,n,t,i,a,"next",e)}function a(e){u(o,n,t,i,a,"throw",e)}i(void 0)}))})},6930:function(e,r,n){function t(e,r){if(null===e||void 0===e)throw Error(r)}n.d(r,{k:function(){return t}})}}]);