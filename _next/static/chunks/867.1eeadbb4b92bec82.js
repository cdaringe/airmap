"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{56347:(e,r,n)=>{n.d(r,{t:()=>a});var t=n(12551),a=function(e){return function(r){var n=(0,t._)(r,2);return["all",[">=",e,n[0]],["<",e,n[1]]]}}},67867:(e,r,n)=>{n.r(r),n.d(r,{getResources:()=>g});var t,a={};n.r(a),n.d(a,{getLevels:()=>f,getLevelsByField:()=>p,makeGetLevels:()=>d});var i=n(34618),u=n(92831),c=n(14952),o=n(61760),s=n(56347),l=["#6fc400","#feff00","#ffaa00","#ff5600","#991113","#4d0173","black"],m=[0,.25,.5,1,2.5,5,20].map(function(e,r,n){return[e,n[r+1]||1/0]}),d=function(e){return function(r){var n=r.isMinMaxDynamicRange,t=r.geojson,a=0,i=1/0,u=-1/0,c=!0,d=!1,p=void 0;try{for(var f,v=t.features[Symbol.iterator]();!(c=(f=v.next()).done);c=!0)(a=f.value.properties[e])>u&&(u=a),a<i&&(i=a)}catch(e){d=!0,p=e}finally{try{c||null==v.return||v.return()}finally{if(d)throw p}}var g=l.length,h=n?(u-i)/g:0,_=n?(0,o._)(Array(g)).map(function(e,r){var n=i+r*h;return[n,n+h]}):m;return{circleCases:_.map((0,s.t)(["get",e])).flatMap(function(e,r){return[e,l[r]]}),colors:l,fieldName:e,ranges:_}}},p=(t={},(0,c._)(t,"PM0.5 μg/m^3 (derived)",d("pm05Derived")),(0,c._)(t,"PM0.5 μg/m^3 (naive)",d("pm05Naive")),(0,c._)(t,"PM2.5 μg/m^3",d("pm_2_5")),(0,c._)(t,"PM0.5 μg/m^3 (calibrated)",d("pm05Calibrated")),(0,c._)(t,"PM0.01-0.03 μg/m^3 (derived)",d("pm01To03Derived")),(0,c._)(t,"PM0.5-3 μg/m^3 (calibrated)",d("pm05To3Calibrated")),t),f=p["PM0.5 μg/m^3 (derived)"],v=n(58875),g=function(){return(0,u._)((0,i._)({},{mapbox:a}),{stream:v})}},58875:(e,r,n)=>{n.r(r),n.d(r,{RHO_GRIMM:()=>c,parse:()=>v,sum:()=>s,toPartialμgPerM3:()=>d,toPartialμgPerM3SansRho:()=>p});var t=n(48967),a=n(65959),i=n(69152),u=n(12551),c=1800,o=[6.842765,7.1751666,7.0114602,6.9088991,7.0263146,6.9180838,7.0393966,6.989318,6.9812267,5.2701795,14.0655402,13.8262107,14.1929174,14.0017841,13.8883794,13.9963284,14.0409634,14.2779903,13.8513492,13.898864,13.6873067,14.3390373,13.8184393,14.1478588,14.0655395,13.8262102,14.1929179,13.8296286,14.062005,13.9963317,14.040958,14.001345,13.96783,14,13.95533,14.00924,14,14,14,14,14],s=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.reduce(function(e,r){return e+r},0)},l=function(e){return e/1e9},m=function(e){return 1e6*e},d=function(e,r,n,t){return m(e)/o[n]*(Math.PI/6)*Math.pow(l(r),3)*t*(1e9/1)},p=function(e,r,n){return m(e)/o[n]*(Math.PI/6)*Math.pow(l(r),3)*(1e9/1)},f={date:function(e){return new Date(e.trim().split(" ").map(function(e,r){if(0===r){var n=(0,u._)(e.split("/"),3),t=n[0],a=n[1],i=n[2],c=function(e){return 1===e.length?"0".concat(e):e};return"".concat(t,"-").concat(c(a),"-").concat(c(i))}return"T".concat(e,".000+01:00")}).join(""))},pm_2_5:function(e){var r=parseFloat(e);return Number.isNaN(r)?(console.error("Expected a number, got a NaN. MiniWras export problem?"),0):r}},v=function(){var e=(0,t._)(function(e){var r,n,t,u,o,s,l=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:{records:[],partial:"",particleDiametersAscending:[]},[4,e.read()];case 1:return t=(n=a.sent()).done,((u=n.value)||t)&&(r.partial+="string"==typeof u?u:u?new TextDecoder().decode(u):"",s=(o=r.partial.split(/\n/g).map(function(e){return e.trim()}).filter(function(e){return!!e})).length-1,o.forEach(function(e,n){if(s!==n||t){var a=e.includes(",")?e.split(","):e.split("	");if(r.headerIndiciesByName){var u=a[r.headerIndiciesByName.Time],o=a[r.headerIndiciesByName["pm2.5 [ug/m3]"]];(0,i.V)(u,"date missing"),(0,i.V)(Number.isFinite(o),"column 'pm2.5 [ug/m3]' missing");for(var l=0,m=r.headerIndiciesByName["10.00 nm"],p=r.headerIndiciesByName["449.48 nm"],v=r.headerIndiciesByName["3238.77 nm"],g=[],h=0,_={all:[],sub500nm:[],sub3000nm:[]};m<v;){var b=parseFloat(a[m]),M=(r.particleDiametersAscending[h]+r.particleDiametersAscending[h+1])/2,N={value:b,diameterMidpointNm:M,calibrationIndex:h};_.all.push(N);var y=d(b,M,h,c);m<p&&(_.sub500nm.push(N),l+=y),m<v&&_.sub3000nm.push(N),++m,++h}console.log({sampleNum:r.records.length,pm05:l,debug:g}),r.records.push({channels:_,date:f.date(u),debug:g,pm05EndCol:p,pm05Naive:l,pm_2_5:f.pm_2_5(o)}),t&&(r.partial="")}else r.headerCells=a,r.headerIndiciesByName=a.reduce(function(e,n,t){var a=n.trim();e[a]=t;var i=a.match(/\s*(\d+\.\d+)\s+nm/);return i&&r.particleDiametersAscending.push(parseInt(i[1],10)),e},{})}else r.partial=e})),[2,t?r:v(e,r)]}})});return function(r){return e.apply(this,arguments)}}()},69152:(e,r,n)=>{n.d(r,{V:()=>t});function t(e,r){if(null==e)throw Error(r)}}}]);